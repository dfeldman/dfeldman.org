<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BlackQuartz CSS Designer</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
    <style>
        :root {
            --sidebar-width: 330px;
            --control-spacing: 8px;
            --bg-color: #f5f5f5;
            --border-color: #ddd;
            --bg-accent: #eee;
            --accent-color: #2271b1;
            --accent-hover: #135e96;
            --text-color: #333;
            --success-color: #00a32a;
            --warning-color: #d63638;
        }
        
        * {
            box-sizing: border-box;
        }
        
        body, html {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            height: 100%;
            overflow: hidden;
            color: var(--text-color);
        }
        h2{ 
            padding-top:10px; 
            margin: 0;
        }
        #app {
            display: flex;
            height: 100vh;
            overflow: hidden;
        }
        
        .controls {
            width: var(--sidebar-width);
            overflow-y: auto;
            padding-left: 15px;
            padding-right: 10px; 
            /*padding-top: 0,*/
            background: var(--bg-color);
            border-right: 1px solid var(--border-color);
            position: relative;
        }
        
        .controls-header {
            position: sticky;
            top: 0;
            background: var(--bg-color);
            padding-bottom: 10px;
            margin-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
            z-index: 10;
        }
        
        .preview {
            flex: 1;
            position: relative;
            height: 100%;
            overflow: hidden;
        }
        
        iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        
        .control-group {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .control-group h3 {
            margin-top: 0;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            cursor: pointer;
        }
        
        .control-group h3 i {
            margin-right: 8px;
        }
        
        .control-group.collapsed .control-content {
            display: none;
        }
        
        .control-group h3 .toggle-icon:before {
            content: '▼';
            display: inline-block;
            margin-right: 8px;
            font-size: 10px;
        }
        
        .control-group.collapsed h3 .toggle-icon:before {
            content: '►';
        }
        
        label {
            display: block;
            margin-bottom: var(--control-spacing);
            font-size: 14px;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 6px;
            margin-bottom: 10px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 14px;
        }
        
        textarea {
            min-height: 80px;
            resize: vertical;
        }
        
        input[type="checkbox"], input[type="radio"] {
            width: auto;
            margin-right: 8px;
        }
        
        .checkbox-label, .radio-label {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .checkbox-label input, .radio-label input {
            margin-bottom: 0;
        }
        
        .color-input {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .color-input input[type="color"] {
            width: 40px;
            padding: 2px;
            margin-right: 10px;
            height: 30px;
        }
        
        .color-input input[type="text"] {
            flex: 1;
            margin-bottom: 0;
        }
        
        button {
            background: #333;
            color: white;
            border: none;
            padding: 8px 15px;
            cursor: pointer;
            border-radius: 4px;
            font-size: 14px;
            transition: background 0.2s;
        }
        
        button:hover {
            background: #555;
        }
        
        .export-button {
            display: block;
            width: 100%;
            background: var(--accent-color);
            margin-bottom: 10px;
        }
        
        .export-button:hover {
            background: var(--accent-hover);
        }
        
        .flex {
            display: flex;
            gap: 10px;
        }
        
        .flex > * {
            flex: 1;
        }
        
        .range-with-value {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .range-with-value input {
            flex: 1;
            margin-right: 10px;
            margin-bottom: 0;
        }
        
        .range-with-value span {
            min-width: 45px;
            text-align: right;
            font-size: 14px;
        }
        
        .font-preview {
            margin-top: 5px;
            padding: 8px;
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 16px;
            height: 40px;
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
            display: flex;
            align-items: center;
        }
        
        .font-search {
            position: relative;
            margin-bottom: 10px;
        }
        
        .font-search input {
            width: 100%;
            padding-left: 30px;
        }
        
        .font-search i {
            position: absolute;
            left: 10px;
            top: 9px;
            color: #888;
        }
        
        .font-results {
            max-height: 200px;
            overflow-y: auto;
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 0 0 4px 4px;
            display: none;
            position: absolute;
            width: 100%;
            z-index: 100;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .font-results.active {
            display: block;
        }
        
        .font-item {
            padding: 8px 10px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .font-item:hover {
            background-color: var(--bg-accent);
        }
        
        .font-category {
            padding: 5px 10px;
            background-color: var(--bg-accent);
            font-weight: bold;
            font-size: 12px;
            text-transform: uppercase;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .tab {
            padding: 8px 12px;
            cursor: pointer;
            background: var(--bg-color);
            font-size: 14px;
        }
        
        .tab.active {
            border-bottom: 2px solid var(--accent-color);
            font-weight: bold;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .wiki-selector {
            margin-bottom: 15px;
        }
        
        .controls-footer {
            position: sticky;
            bottom: 0;
            background: var(--bg-color);
            padding-top: 10px;
            margin-top: 10px;
            border-top: 1px solid var(--border-color);
            z-index: 10;
        }
        
        .preset-button {
            background: #666;
            margin-bottom: 5px;
        }
        
        .preset-button:hover {
            background: #888;
        }
        
        .loading {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255,255,255,0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        
        .spinner {
            border: 4px solid rgba(0,0,0,0.1);
            border-radius: 50%;
            border-top: 4px solid var(--accent-color);
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .message {
            padding: 10px;
            margin-bottom: 15px;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .message.success {
            background-color: rgba(0, 163, 42, 0.1);
            border: 1px solid var(--success-color);
            color: var(--success-color);
        }
        
        .message.error {
            background-color: rgba(214, 54, 56, 0.1);
            border: 1px solid var(--warning-color);
            color: var(--warning-color);
        }
        
        .wiki-search-results {
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            margin-bottom: 15px;
            background: white;
            display: none;
        }
        
        .wiki-search-results.active {
            display: block;
        }
        
        .wiki-result-item {
            padding: 8px 10px;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
        }
        
        .wiki-result-item:hover {
            background-color: var(--bg-accent);
        }
        
        .wiki-result-title {
            font-weight: bold;
        }
        
        .wiki-result-snippet {
            font-size: 12px;
            color: #666;
            margin-top: 4px;
        }
        
        .segmented-control {
            display: flex;
            margin-bottom: 10px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            overflow: hidden;
        }
        
        .segmented-control label {
            margin: 0;
            flex: 1;
            text-align: center;
            padding: 6px;
            background: var(--bg-color);
            border-right: 1px solid var(--border-color);
            cursor: pointer;
            font-size: 13px;
        }
        
        .segmented-control label:last-child {
            border-right: none;
        }
        
        .segmented-control input[type="radio"] {
            display: none;
        }
        
        .segmented-control input[type="radio"]:checked + label {
            background: var(--accent-color);
            color: white;
        }
        
        /* Custom scrollbar */
        .controls::-webkit-scrollbar {
            width: 10px;
        }
        
        .controls::-webkit-scrollbar-track {
            background: var(--bg-color);
        }
        
        .controls::-webkit-scrollbar-thumb {
            background: #bbb;
            border-radius: 5px;
        }
        
        .controls::-webkit-scrollbar-thumb:hover {
            background: #999;
        }
        
        .color-palette {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 5px;
            margin-bottom: 10px;
        }
        
        .color-swatch {
            height: 24px;
            border-radius: 3px;
            cursor: pointer;
            border: 1px solid var(--border-color);
        }
        
        .image-upload-preview {
            max-width: 100%;
            height: 100px;
            object-fit: cover;
            margin-bottom: 10px;
            background-color: #f1f1f1;
            border: 1px dashed #ccc;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .image-upload-preview img {
            max-width: 100%;
            max-height: 100px;
            object-fit: contain;
        }
        
        .nav-link {
            cursor: pointer;
            color: var(--accent-color);
            text-decoration: underline;
            display: inline-block;
            margin-top: 5px;
            font-size: 14px;
        }

        .preview.responsive-mode {
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: #f0f0f0;
        }

        .device-wrapper {
        border: 1px solid #ccc;
        overflow: hidden;
        transition: all 0.3s ease;
        box-shadow: 0 0 20px rgba(0,0,0,0.1);
        background-color: white;
        }

        .device-desktop {
        width: 90%;
        height: 90%;
        }

        .device-tablet {
        width: 768px;
        height: 1024px;
        max-height: 90%;
        }

        .device-mobile {
        width: 375px;
        height: 667px;
        max-height: 90%;
        }

        .device-wrapper iframe {
        width: 100%;
        height: 100%;
        border: none;
        }

    </style>
</head>
<body>
    <div id="app">
        <div class="controls">
            <div class="controls-header">
                <h2><span style="color:#333">Black</span><span style="color:#2271b1">Quartz</span></h2>
                <div class="tabs">
                    <div :class="['tab', activeTab === 'content' ? 'active' : '']" @click="activeTab = 'content'">Content</div>
                    <div :class="['tab', activeTab === 'design' ? 'active' : '']" @click="activeTab = 'design'">Design</div>
                    <div :class="['tab', activeTab === 'export' ? 'active' : '']" @click="activeTab = 'export'">Import/Export</div>
                </div>
            </div>
            
            <!-- Content Tab -->
            <div :class="['tab-content', activeTab === 'content' ? 'active' : '']">
                <div class="control-group">
                    <h3>Responsive Preview</h3>
                    <label class="checkbox-label">
                      <input type="checkbox" v-model="responsivePreview.enabled">
                      Enable Responsive Preview
                    </label>
                    <div v-if="responsivePreview.enabled">
                      <div class="segmented-control">
                        <input type="radio" id="device-desktop" value="desktop" v-model="responsivePreview.device">
                        <label for="device-desktop">Desktop</label>
                        <input type="radio" id="device-tablet" value="tablet" v-model="responsivePreview.device">
                        <label for="device-tablet">Tablet</label>
                        <input type="radio" id="device-mobile" value="mobile" v-model="responsivePreview.device">
                        <label for="device-mobile">Mobile</label>
                      </div>
                    </div>
                </div>
                <div class="control-group">
                    <h3 @click="toggleGroup('contentSource')">
                        <span class="toggle-icon"></span>Content Source
                    </h3>
                    <div class="control-content" v-show="!collapsedGroups.contentSource">
                        <div class="tabs">
                            <div :class="['tab', p.content.source === 'lorem' ? 'active' : '']" @click="setContentSource('lorem')">Lorem Ipsum</div>
                            <div :class="['tab', p.content.source === 'wiki' ? 'active' : '']" @click="setContentSource('wiki')">Wikipedia</div>
                        </div>
                        
                        <div v-if="p.content.source === 'lorem'">
                            <label>Paragraphs</label>
                            <div class="range-with-value">
                                <input type="range" min="3" max="15" v-model.number="p.content.loremParagraphs">
                                <span>{{ p.content.loremParagraphs }}</span>
                            </div>
                            
                            <label>Images</label>
                            <div class="range-with-value">
                                <input type="range" min="2" max="8" v-model.number="p.content.loremImages">
                                <span>{{ p.content.loremImages }}</span>
                            </div>
                            
                            <label>Headings</label>
                            <div class="range-with-value">
                                <input type="range" min="2" max="6" v-model.number="p.content.loremHeadings">
                                <span>{{ p.content.loremHeadings }}</span>
                            </div>
                            
                            <button @click="generateNewLorem">Regenerate Lorem Text</button>
                        </div>
                        
                        <div v-if="p.content.source === 'wiki'">
                            <label>Search Wikipedia</label>
                            <div class="font-search">
                                <i class="fas fa-search"></i>
                                <input 
                                    type="text" 
                                    v-model="wikiSearch" 
                                    @input="debouncedWikiSearch"
                                    placeholder="Search for an article...">
                            </div>
                            
                            <div v-if="wikiSearching" class="loading" style="position:relative; height:50px;">
                                <div class="spinner"></div>
                            </div>
                            
                            <div v-if="wikiError" class="message error">
                                {{ wikiError }}
                            </div>
                            
                            <div :class="['wiki-search-results', wikiResults.length > 0 ? 'active' : '']">
                                <div 
                                    v-for="result in wikiResults" 
                                    :key="result.pageid" 
                                    class="wiki-result-item"
                                    @click="selectWikiArticle(result)">
                                    <div class="wiki-result-title" v-html="result.title"></div>
                                    <div class="wiki-result-snippet" v-html="result.snippet"></div>
                                </div>
                            </div>
                            
                            <div v-if="currentWikiArticle">
                                <div class="message success">
                                    <strong>Selected Article:</strong> {{ currentWikiArticle.title }}
                                </div>
                                <button @click="fetchWikiArticleContent">Load Article Content</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Design Tab -->
            <div :class="['tab-content', activeTab === 'design' ? 'active' : '']">
                <!-- Background Settings -->
                <div :class="['control-group', collapsedGroups.background ? 'collapsed' : '']">
                    <h3 @click="toggleGroup('background')">
                        <span class="toggle-icon"></span>Background
                    </h3>
                    <div class="control-content">
                        <div class="color-input">
                            <label>Color 1</label>
                            <input type="color" v-model="p.bg.c1">
                            <input type="text" v-model="p.bg.c1">
                        </div>
                        <div class="color-input">
                            <label>Color 2</label>
                            <input type="color" v-model="p.bg.c2">
                            <input type="text" v-model="p.bg.c2">
                        </div>
                        <label>Style</label>
                        <select v-model="p.bg.style">
                            <option value="solid">Solid</option>
                            <option value="gradient">Diagonal Gradient</option>
                            <option value="circles">Circles</option>
                            <option value="squares">Squares</option>
                            <option value="polkadots">Polka Dots</option>
                            <option value="stripes">Stripes</option>
                            <option value="triangles">Triangles</option>
                            <option value="zigzag">Zigzag</option>
                            <option value="noise">Noise Texture</option>
                            <option value="wave">Wave Pattern</option>
                        </select>
                        
                        <div v-if="p.bg.style !== 'solid' && p.bg.style !== 'gradient'">
                            <label>Pattern Size</label>
                            <div class="range-with-value">
                                <input type="range" min="10" max="100" v-model.number="p.bg.patternSize">
                                <span>{{ p.bg.patternSize }}px</span>
                            </div>
                        </div>
                        
                        <label>Suggested Color Combinations</label>
                        <div class="color-palette">
                            <div 
                                v-for="palette in colorPalettes" 
                                class="color-swatch" 
                                :style="{ background: palette.c1 }"
                                @click="applyColorPalette(palette)">
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Page Settings -->
                <div :class="['control-group', collapsedGroups.page ? 'collapsed' : '']">
                    <h3 @click="toggleGroup('page')">
                        <span class="toggle-icon"></span>Page
                    </h3>
                    <div class="control-content">
                        <label class="checkbox-label">
                            <input type="checkbox" v-model="p.page.enabled">
                            Enable Page Background
                        </label>
                        <div v-if="p.page.enabled">
                            <div class="color-input">
                                <label>Background Color</label>
                                <input type="color" v-model="p.page.bgColor">
                                <input type="text" v-model="p.page.bgColor">
                            </div>
                            
                            <label>Shadow Size (px)</label>
                            <div class="range-with-value">
                                <input type="range" min="0" max="50" v-model.number="p.page.shadowSize">
                                <span>{{ p.page.shadowSize }}px</span>
                            </div>
                            
                            <label>Border Size (px)</label>
                            <div class="range-with-value">
                                <input type="range" min="0" max="20" v-model.number="p.page.borderSize">
                                <span>{{ p.page.borderSize }}px</span>
                            </div>
                            
                            <div class="color-input">
                                <label>Border Color</label>
                                <input type="color" v-model="p.page.borderColor">
                                <input type="text" v-model="p.page.borderColor">
                            </div>
                            
                            <label>Page Padding (px)</label>
                            <div class="flex">
                                <div>
                                    <label>Horizontal</label>
                                    <div class="range-with-value">
                                        <input type="range" min="10" max="80" v-model.number="p.page.paddingX">
                                        <span>{{ p.page.paddingX }}px</span>
                                    </div>
                                </div>
                                <div>
                                    <label>Vertical</label>
                                    <div class="range-with-value">
                                        <input type="range" min="10" max="80" v-model.number="p.page.paddingY">
                                        <span>{{ p.page.paddingY }}px</span>
                                    </div>
                                </div>
                            </div>
                            
                            <label>Width (px)</label>
                            <div class="range-with-value">
                                <input type="range" min="600" max="1400" step="50" v-model.number="p.page.maxWidth">
                                <span>{{ p.page.maxWidth }}px</span>
                            </div>
                            
                            <label>Border Radius (px)</label>
                            <div class="range-with-value">
                                <input type="range" min="0" max="30" v-model.number="p.page.borderRadius">
                                <span>{{ p.page.borderRadius }}px</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Typography Settings -->
                <div :class="['control-group', collapsedGroups.typography ? 'collapsed' : '']">
                    <h3 @click="toggleGroup('typography')">
                        <span class="toggle-icon"></span>Typography
                    </h3>
                    <div class="control-content">
                        <h4>Body Text</h4>
                        <label>Font Family</label>
                        <div class="font-search">
                            <i class="fas fa-search"></i>
                            <input type="text" v-model="bodyFontSearch" @focus="showBodyFonts = true" placeholder="Search Google Fonts...">
                            <div :class="['font-results', showBodyFonts ? 'active' : '']" v-if="filteredBodyFonts.length > 0" @mouseleave="showBodyFonts = false">
                                <div v-for="(group, category) in groupedBodyFonts" :key="category">
                                    <div class="font-category">{{ category }}</div>
                                    <div v-for="font in group" :key="font.family" class="font-item" @click="selectBodyFont(font)">
                                        {{ font.family }}
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="font-preview" :style="{ fontFamily: p.type.bodyFont }">
                            The quick brown fox jumps over the lazy dog
                        </div>
                        
                        <div class="flex">
                            <div>
                                <label>Line Height</label>
                                <div class="range-with-value">
                                    <input type="range" min="1" max="2" step="0.1" v-model.number="p.type.lineHeight">
                                    <span>{{ p.type.lineHeight }}</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="flex">
                            <div>
                                <label>Text Color</label>
                                <input type="color" v-model="p.type.textColor">
                            </div>
                            <div>
                                <label>Size (px)</label>
                                <input type="number" min="12" max="24" v-model.number="p.type.textSize">
                            </div>
                        </div>
                        
                        <h4>Headings</h4>
                        <label>Font Family</label>
                        <div class="font-search">
                            <i class="fas fa-search"></i>
                            <input type="text" v-model="headingFontSearch" @focus="showHeadingFonts = true" placeholder="Search Google Fonts...">
                            <div :class="['font-results', showHeadingFonts ? 'active' : '']" v-if="filteredHeadingFonts.length > 0" @mouseleave="showHeadingFonts = false">
                                <div v-for="(group, category) in groupedHeadingFonts" :key="category">
                                    <div class="font-category">{{ category }}</div>
                                    <div v-for="font in group" :key="font.family" class="font-item" @click="selectHeadingFont(font)">
                                        {{ font.family }}
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="font-preview" :style="{ fontFamily: p.type.headingFont }">
                            The quick brown fox jumps over the lazy dog
                        </div>
                        
                        <h4>Title Typography</h4>
                        <div class="flex">
                            <div>
                                <label>Color</label>
                                <input type="color" v-model="p.type.titleColor">
                            </div>
                            <div>
                                <label>Size (px)</label>
                                <input type="number" min="16" max="72" v-model.number="p.type.titleSize">
                            </div>
                        </div>
                        
                        <label>Title Style</label>
                        <select v-model="p.type.titleStyle">
                            <option value="normal">Normal</option>
                            <option value="underline">Underline</option>
                            <option value="highlight">Highlight</option>
                            <option value="bordered">Bordered</option>
                            <option value="shadow">Shadow</option>
                            <option value="gradient">Gradient Text</option>
                        </select>
                        
                        <label>Title Alignment</label>
                        <div class="segmented-control">
                            <input type="radio" id="align-left" value="left" v-model="p.type.titleAlign">
                            <label for="align-left">Left</label>
                            <input type="radio" id="align-center" value="center" v-model="p.type.titleAlign">
                            <label for="align-center">Center</label>
                            <input type="radio" id="align-right" value="right" v-model="p.type.titleAlign">
                            <label for="align-right">Right</label>
                        </div>
                        
                        <label>Title Padding (px)</label>
                        <div class="flex">
                            <div>
                                <label>Horizontal</label>
                                <div class="range-with-value">
                                    <input type="range" min="0" max="60" v-model.number="p.type.titlePaddingX">
                                    <span>{{ p.type.titlePaddingX }}px</span>
                                </div>
                            </div>
                            <div>
                                <label>Vertical</label>
                                <div class="range-with-value">
                                    <input type="range" min="0" max="60" v-model.number="p.type.titlePaddingY">
                                    <span>{{ p.type.titlePaddingY }}px</span>
                                </div>
                            </div>
                        </div>
                        
                        <label>Space Below Title (px)</label>
                        <div class="range-with-value">
                            <input type="range" min="10" max="60" v-model.number="p.type.titleSpaceBelow">
                            <span>{{ p.type.titleSpaceBelow }}px</span>
                        </div>
                        
                        <h4>Heading Typography</h4>
                        <div class="flex">
                            <div>
                                <label>Color</label>
                                <input type="color" v-model="p.type.headingColor">
                            </div>
                            <div>
                                <label>Size (px)</label>
                                <input type="number" min="14" max="48" v-model.number="p.type.headingSize">
                            </div>
                        </div>
                        
                        <label>Heading Style</label>
                        <select v-model="p.type.headingStyle">
                            <option value="normal">Normal</option>
                            <option value="underline">Underline</option>
                            <option value="highlight">Highlight</option>
                            <option value="leftBorder">Left Border</option>
                            <option value="gradient">Gradient Text</option>
                        </select>
                        
                        <label>Space Above Heading (px)</label>
                        <div class="range-with-value">
                            <input type="range" min="10" max="50" v-model.number="p.type.headingSpaceAbove">
                            <span>{{ p.type.headingSpaceAbove }}px</span>
                        </div>
                        
                        <label>Space Below Heading (px)</label>
                        <div class="range-with-value">
                            <input type="range" min="10" max="40" v-model.number="p.type.headingSpaceBelow">
                            <span>{{ p.type.headingSpaceBelow }}px</span>
                        </div>
                        
                        <h4>Links</h4>
                        <div class="flex">
                            <div>
                                <label>Color</label>
                                <input type="color" v-model="p.type.linkColor">
                            </div>
                            <div>
                                <label>Hover Color</label>
                                <input type="color" v-model="p.type.linkHoverColor">
                            </div>
                        </div>
                        
                        <label class="checkbox-label">
                            <input type="checkbox" v-model="p.type.linkUnderline">
                            Underline Links
                        </label>
                        
                        <label>Hover Effect</label>
                        <select v-model="p.type.linkHoverEffect">
                            <option value="none">None</option>
                            <option value="underline">Underline on Hover</option>
                            <option value="highlight">Highlight on Hover</option>
                            <option value="bold">Bold on Hover</option>
                        </select>
                    </div>
                </div>
                
                <!-- Hero Panel -->
                <div :class="['control-group', collapsedGroups.hero ? 'collapsed' : '']">
                    <h3 @click="toggleGroup('hero')">
                        <span class="toggle-icon"></span>Hero Panel
                    </h3>
                    <div class="control-content">
                        <label class="checkbox-label">
                            <input type="checkbox" v-model="p.hero.enabled">
                            Enable Hero Panel
                        </label>
                        <div v-if="p.hero.enabled">
                            <label>Hero Background Type</label>
                            <div class="segmented-control">
                                <input type="radio" id="hero-color" value="color" v-model="p.hero.type">
                                <label for="hero-color">Color</label>
                                <input type="radio" id="hero-image" value="image" v-model="p.hero.type">
                                <label for="hero-image">Image</label>
                            </div>
                            
                            <div v-if="p.hero.type === 'color'">
                                <div class="color-input">
                                    <label>Color 1</label>
                                    <input type="color" v-model="p.hero.c1">
                                    <input type="text" v-model="p.hero.c1">
                                </div>
                                <div class="color-input">
                                    <label>Color 2</label>
                                    <input type="color" v-model="p.hero.c2">
                                    <input type="text" v-model="p.hero.c2">
                                </div>
                                <label>Style</label>
                                <select v-model="p.hero.style">
                                    <option value="solid">Solid</option>
                                    <option value="gradient">Linear Gradient</option>
                                    <option value="radial">Radial Gradient</option>
                                    <option value="angled">Angled Sections</option>
                                    <option value="wave">Wave Border</option>
                                </select>
                            </div>
                            
                            <div v-if="p.hero.type === 'image'">
                                <label>Image URL (or use placeholder)</label>
                                <input type="text" v-model="p.hero.imageUrl" placeholder="https://example.com/image.jpg">
                                
                                <div class="image-upload-preview">
                                    <img v-if="p.hero.imageUrl" :src="p.hero.imageUrl" alt="Hero Background">
                                    <div v-else>Hero background preview</div>
                                </div>
                                
                                <label>Image Placeholder Size</label>
                                <div class="range-with-value">
                                    <input type="range" min="500" max="1500" step="100" v-model.number="p.hero.placeholderWidth">
                                    <span>{{ p.hero.placeholderWidth }}px</span>
                                </div>
                                
                                <button @click="generateRandomHeroImage">Generate Random Image</button>
                                
                                <label>Overlay Color</label>
                                <div class="color-input">
                                    <input type="color" v-model="p.hero.overlayColor">
                                    <input type="text" v-model="p.hero.overlayColor">
                                </div>
                                
                                <label>Overlay Opacity</label>
                                <div class="range-with-value">
                                    <input type="range" min="0" max="1" step="0.1" v-model.number="p.hero.overlayOpacity">
                                    <span>{{ p.hero.overlayOpacity }}</span>
                                </div>
                            </div>
                            
                            <label>Padding (px)</label>
                            <div class="flex">
                                <div>
                                    <label>Horizontal</label>
                                    <div class="range-with-value">
                                        <input type="range" min="20" max="100" v-model.number="p.hero.paddingX">
                                        <span>{{ p.hero.paddingX }}px</span>
                                    </div>
                                </div>
                                <div>
                                    <label>Vertical</label>
                                    <div class="range-with-value">
                                        <input type="range" min="20" max="100" v-model.number="p.hero.paddingY">
                                        <span>{{ p.hero.paddingY }}px</span>
                                    </div>
                                </div>
                            </div>
                            
                            <label>Border Radius (px)</label>
                            <div class="range-with-value">
                                <input type="range" min="0" max="30" v-model.number="p.hero.borderRadius">
                                <span>{{ p.hero.borderRadius }}px</span>
                            </div>
                            
                            <label>Title Text Effect</label>
                            <select v-model="p.hero.titleEffect">
                                <option value="none">None</option>
                                <option value="shadow">Text Shadow</option>
                                <option value="glow">Glowing</option>
                                <option value="outline">Outline</option>
                                <option value="contrast">High Contrast</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <!-- Image Settings -->
                <div :class="['control-group', collapsedGroups.images ? 'collapsed' : '']">
                    <h3 @click="toggleGroup('images')">
                        <span class="toggle-icon"></span>Images
                    </h3>
                    <div class="control-content">
                        <label>Border Size (px)</label>
                        <div class="range-with-value">
                            <input type="range" min="0" max="20" v-model.number="p.img.borderSize">
                            <span>{{ p.img.borderSize }}px</span>
                        </div>
                        
                        <div class="color-input">
                            <label>Border Color</label>
                            <input type="color" v-model="p.img.borderColor">
                            <input type="text" v-model="p.img.borderColor">
                        </div>
                        
                        <label>Padding (px)</label>
                        <div class="range-with-value">
                            <input type="range" min="0" max="30" v-model.number="p.img.padding">
                            <span>{{ p.img.padding }}px</span>
                        </div>
                        
                        <label>Caption Size (px)</label>
                        <div class="range-with-value">
                            <input type="range" min="10" max="20" v-model.number="p.img.captionSize">
                            <span>{{ p.img.captionSize }}px</span>
                        </div>
                        
                        <label>Border Radius (px)</label>
                        <div class="range-with-value">
                            <input type="range" min="0" max="20" v-model.number="p.img.borderRadius">
                            <span>{{ p.img.borderRadius }}px</span>
                        </div>
                        
                        <label>Image Style</label>
                        <select v-model="p.img.style">
                            <option value="normal">Normal</option>
                            <option value="shadow">Shadow</option>
                            <option value="polaroid">Polaroid</option>
                            <option value="lifted">Lifted Edge</option>
                            <option value="frame">Ornate Frame</option>
                        </select>
                        
                        <label>Image Hover Effect</label>
                        <select v-model="p.img.hoverEffect">
                            <option value="none">None</option>
                            <option value="zoom">Zoom</option>
                            <option value="brighten">Brighten</option>
                            <option value="saturate">Saturate</option>
                            <option value="lift">Lift</option>
                        </select>
                        
                        <label>Image Width</label>
                        <select v-model="p.img.displayWidth">
                            <option value="normal">Normal (100%)</option>
                            <option value="wide">Wide (110%)</option>
                            <option value="full">Full Width</option>
                            <option value="breakout">Breakout</option>
                        </select>
                    </div>
                </div>
                <!-- Image Links Settings -->
                <div :class="['control-group', collapsedGroups.imageLinks ? 'collapsed' : '']">
                    <h3 @click="toggleGroup('imageLinks')">
                        <span class="toggle-icon"></span>Image Links
                    </h3>
                    <div class="control-content">
                        <label>Display Layout</label>
                        <select v-model="p.imageLinks.layout">
                            <option value="grid">Grid</option>
                            <option value="carousel">Carousel</option>
                            <option value="list">List</option>
                        </select>
                        
                        <div v-if="p.imageLinks.layout === 'grid'">
                            <label>Grid Style</label>
                            <select v-model="p.imageLinks.displayStyle">
                                <option value="standard">Standard Grid</option>
                                <option value="masonry">Masonry</option>
                            </select>
                            
                            <label>Items Per Row</label>
                            <div class="range-with-value">
                                <input type="range" min="2" max="5" v-model.number="p.imageLinks.itemsPerRow">
                                <span>{{ p.imageLinks.itemsPerRow }}</span>
                            </div>
                        </div>
                        
                        <div v-if="p.imageLinks.layout === 'carousel'">
                            <label>Visible Items</label>
                            <div class="range-with-value">
                                <input type="range" min="2" max="5" v-model.number="p.imageLinks.itemsPerRow">
                                <span>{{ p.imageLinks.itemsPerRow }}</span>
                            </div>
                        </div>
                        
                        <div v-if="p.imageLinks.layout === 'list'">
                            <label>Image Position</label>
                            <div class="segmented-control">
                                <input type="radio" id="img-left" value="left" v-model="p.imageLinks.imagePosition">
                                <label for="img-left">Left</label>
                                <input type="radio" id="img-right" value="right" v-model="p.imageLinks.imagePosition">
                                <label for="img-right">Right</label>
                            </div>
                        </div>
                        
                        <label>Spacing Between Items (px)</label>
                        <div class="range-with-value">
                            <input type="range" min="5" max="40" v-model.number="p.imageLinks.spacing">
                            <span>{{ p.imageLinks.spacing }}px</span>
                        </div>
                        
                        <label>Border Size (px)</label>
                        <div class="range-with-value">
                            <input type="range" min="0" max="20" v-model.number="p.imageLinks.borderSize">
                            <span>{{ p.imageLinks.borderSize }}px</span>
                        </div>
                        
                        <div class="color-input">
                            <label>Border Color</label>
                            <input type="color" v-model="p.imageLinks.borderColor">
                            <input type="text" v-model="p.imageLinks.borderColor">
                        </div>
                        
                        <label>Border Radius (px)</label>
                        <div class="range-with-value">
                            <input type="range" min="0" max="20" v-model.number="p.imageLinks.borderRadius">
                            <span>{{ p.imageLinks.borderRadius }}px</span>
                        </div>
                        
                        <label>Caption Size (px)</label>
                        <div class="range-with-value">
                            <input type="range" min="10" max="20" v-model.number="p.imageLinks.captionSize">
                            <span>{{ p.imageLinks.captionSize }}px</span>
                        </div>
                        
                        <label>Caption Color</label>
                        <div class="color-input">
                            <input type="color" v-model="p.imageLinks.captionColor">
                            <input type="text" v-model="p.imageLinks.captionColor">
                        </div>
                        
                        <label>Style</label>
                        <select v-model="p.imageLinks.style">
                            <option value="normal">Normal</option>
                            <option value="shadow">Shadow</option>
                            <option value="bordered">Bordered</option>
                            <option value="raised">Raised</option>
                        </select>
                        
                        <label>Hover Effect</label>
                        <select v-model="p.imageLinks.hoverEffect">
                            <option value="none">None</option>
                            <option value="zoom">Zoom</option>
                            <option value="brighten">Brighten</option>
                            <option value="lift">Lift</option>
                            <option value="glow">Glow</option>
                        </select>
                    </div>
                </div>
                <!-- Section Breaks -->
                <div :class="['control-group', collapsedGroups.sections ? 'collapsed' : '']">
                    <h3 @click="toggleGroup('sections')">
                        <span class="toggle-icon"></span>Section Breaks
                    </h3>
                    <div class="control-content">
                        <div class="color-input">
                            <label>Color</label>
                            <input type="color" v-model="p.section.color">
                            <input type="text" v-model="p.section.color">
                        </div>
                        
                        <label>Size (px)</label>
                        <div class="range-with-value">
                            <input type="range" min="1" max="10" v-model.number="p.section.size">
                            <span>{{ p.section.size }}px</span>
                        </div>
                        
                        <label>Style</label>
                        <select v-model="p.section.style">
                            <option value="solid">Solid</option>
                            <option value="dashed">Dashed</option>
                            <option value="dotted">Dotted</option>
                            <option value="double">Double</option>
                            <option value="wavy">Wavy</option>
                            <option value="symbols">Symbols</option>
                            <option value="gradient">Gradient</option>
                            <option value="faded">Faded Edges</option>
                            <option value="ornate">Ornate</option>
                        </select>
                        
                        <div v-if="p.section.style === 'symbols'">
                            <label>Symbol</label>
                            <select v-model="p.section.symbol">
                                <option value="•">• Bullet</option>
                                <option value="★">★ Star</option>
                                <option value="◆">◆ Diamond</option>
                                <option value="❧">❧ Floral</option>
                                <option value="§">§ Section</option>
                                <option value="✧">✧ Sparkle</option>
                                <option value="♦">♦ Diamond Suit</option>
                                <option value="✿">✿ Flower</option>
                                <option value="❖">❖ Black Diamond</option>
                            </select>
                        </div>
                        
                        <label>Margin (px)</label>
                        <div class="range-with-value">
                            <input type="range" min="20" max="80" v-model.number="p.section.margin">
                            <span>{{ p.section.margin }}px</span>
                        </div>
                    </div>
                </div>
                <!-- Blockquote Styling -->
                <div :class="['control-group', collapsedGroups.blockquote ? 'collapsed' : '']">
                    <h3 @click="toggleGroup('blockquote')">
                        <span class="toggle-icon"></span>Blockquotes
                    </h3>
                    <div class="control-content">
                        <div class="color-input">
                            <label>Border Color</label>
                            <input type="color" v-model="p.blockquote.borderColor">
                            <input type="text" v-model="p.blockquote.borderColor">
                        </div>
                        
                        <label>Border Size (px)</label>
                        <div class="range-with-value">
                            <input type="range" min="0" max="10" v-model.number="p.blockquote.borderSize">
                            <span>{{ p.blockquote.borderSize }}px</span>
                        </div>
                        
                        <label>Border Position</label>
                        <select v-model="p.blockquote.borderPosition">
                            <option value="left">Left Side</option>
                            <option value="right">Right Side</option>
                            <option value="top">Top</option>
                            <option value="bottom">Bottom</option>
                            <option value="all">All Sides</option>
                        </select>
                        
                        <div class="color-input">
                            <label>Background Color</label>
                            <input type="color" v-model="p.blockquote.backgroundColor">
                            <input type="text" v-model="p.blockquote.backgroundColor">
                        </div>
                        
                        <label>Padding (px)</label>
                        <div class="range-with-value">
                            <input type="range" min="10" max="40" v-model.number="p.blockquote.padding">
                            <span>{{ p.blockquote.padding }}px</span>
                        </div>
                        
                        <div class="color-input">
                            <label>Text Color (empty for inherited)</label>
                            <input type="color" v-model="p.blockquote.textColor">
                            <input type="text" v-model="p.blockquote.textColor">
                        </div>
                        
                        <label>Font Style</label>
                        <select v-model="p.blockquote.fontStyle">
                            <option value="normal">Normal</option>
                            <option value="italic">Italic</option>
                        </select>
                        
                        <label class="checkbox-label">
                            <input type="checkbox" v-model="p.blockquote.quoteMarks">
                            Show Quote Marks
                        </label>
                    </div>
                </div>

                <!-- Table Styling -->
                <div :class="['control-group', collapsedGroups.table ? 'collapsed' : '']">
                    <h3 @click="toggleGroup('table')">
                        <span class="toggle-icon"></span>Tables
                    </h3>
                    <div class="control-content">
                        <div class="color-input">
                            <label>Border Color</label>
                            <input type="color" v-model="p.table.borderColor">
                            <input type="text" v-model="p.table.borderColor">
                        </div>
                        
                        <label>Border Size (px)</label>
                        <div class="range-with-value">
                            <input type="range" min="0" max="5" v-model.number="p.table.borderSize">
                            <span>{{ p.table.borderSize }}px</span>
                        </div>
                        
                        <div class="color-input">
                            <label>Header Background</label>
                            <input type="color" v-model="p.table.headerBackground">
                            <input type="text" v-model="p.table.headerBackground">
                        </div>
                        
                        <div class="color-input">
                            <label>Header Text Color</label>
                            <input type="color" v-model="p.table.headerTextColor">
                            <input type="text" v-model="p.table.headerTextColor">
                        </div>
                        
                        <label class="checkbox-label">
                            <input type="checkbox" v-model="p.table.alternateRows">
                            Alternate Row Colors
                        </label>
                        
                        <div v-if="p.table.alternateRows" class="color-input">
                            <label>Alternate Row Color</label>
                            <input type="color" v-model="p.table.alternateColor">
                            <input type="text" v-model="p.table.alternateColor">
                        </div>
                    </div>
                </div>

                <!-- List Styling -->
                <div :class="['control-group', collapsedGroups.list ? 'collapsed' : '']">
                    <h3 @click="toggleGroup('list')">
                        <span class="toggle-icon"></span>Lists
                    </h3>
                    <div class="control-content">
                        <label>Bullet Style</label>
                        <select v-model="p.list.bulletStyle">
                            <option value="default">Default</option>
                            <option value="custom">Custom Symbol</option>
                            <option value="none">No Bullets</option>
                        </select>
                        
                        <div v-if="p.list.bulletStyle === 'custom'">
                            <label>Custom Bullet Symbol</label>
                            <select v-model="p.list.bulletSymbol">
                                <option value="•">• Bullet</option>
                                <option value="▪">▪ Square</option>
                                <option value="▸">▸ Triangle</option>
                                <option value="✓">✓ Checkmark</option>
                                <option value="❖">❖ Diamond</option>
                                <option value="★">★ Star</option>
                                <option value="✦">✦ Star Outline</option>
                                <option value="♦">♦ Diamond Suit</option>
                                <option value="➤">➤ Arrow</option>
                            </select>
                        </div>
                        
                        <div class="color-input">
                            <label>Bullet Color (empty for inherited)</label>
                            <input type="color" v-model="p.list.bulletColor">
                            <input type="text" v-model="p.list.bulletColor">
                        </div>
                        
                        <label>List Indentation (px)</label>
                        <div class="range-with-value">
                            <input type="range" min="10" max="60" v-model.number="p.list.indentation">
                            <span>{{ p.list.indentation }}px</span>
                        </div>
                        
                        <label>Item Spacing (px)</label>
                        <div class="range-with-value">
                            <input type="range" min="0" max="20" v-model.number="p.list.spacing">
                            <span>{{ p.list.spacing }}px</span>
                        </div>
                    </div>
                </div>
                <!-- Advanced Settings -->
                <div :class="['control-group', collapsedGroups.advanced ? 'collapsed' : '']">
                    <h3 @click="toggleGroup('advanced')">
                        <span class="toggle-icon"></span>Advanced
                    </h3>
                    <div class="control-content">
                        <label>Content Width</label>
                        <div class="range-with-value">
                            <input type="range" min="50" max="100" v-model.number="p.advanced.contentWidth">
                            <span>{{ p.advanced.contentWidth }}%</span>
                        </div>
                        
                        <label>Paragraph Indentation (px)</label>
                        <div class="range-with-value">
                            <input type="range" min="0" max="30" v-model.number="p.advanced.paragraphIndent">
                            <span>{{ p.advanced.paragraphIndent }}px</span>
                        </div>
                        
                        <label>Paragraph Spacing (px)</label>
                        <div class="range-with-value">
                            <input type="range" min="10" max="40" v-model.number="p.advanced.paragraphSpacing">
                            <span>{{ p.advanced.paragraphSpacing }}px</span>
                        </div>
                        
                        <label>Custom CSS</label>
                        <textarea v-model="p.advanced.customCSS" placeholder="Enter custom CSS rules here..."></textarea>
                    </div>
                </div>
            </div>
            
            <!-- Export Tab -->
            <div :class="['tab-content', activeTab === 'export' ? 'active' : '']">
                <div class="control-group">
                    <h3>Export Options</h3>
                    <button class="export-button" @click="exportCSS">Export CSS</button>
                    <button class="export-button" @click="exportHTML">Export HTML Demo</button>
                    <button class="export-button" @click="copyCSS">Copy CSS to Clipboard</button>
                    <button class="export-button" @click="exportThemeJSON">Export Theme as JSON</button>
                    <button class="export-button" @click="importThemeJSON">Import Theme from JSON</button>
                </div>
                
                <div class="control-group">
                    <h3>Theme Presets</h3>
                    <button class="preset-button" @click="applyPreset('modern')">Modern Minimal</button>
                    <button class="preset-button" @click="applyPreset('dark')">Dark Mode</button>
                    <button class="preset-button" @click="applyPreset('newspaper')">Newspaper</button>
                    <button class="preset-button" @click="applyPreset('magazine')">Magazine</button>
                    <button class="preset-button" @click="applyPreset('colorful')">Colorful</button>
                    <button class="preset-button" @click="applyPreset('elegant')">Elegant Serif</button>
                    <button class="preset-button" @click="applyPreset('minimal')">Ultra Minimal</button>
                    <button class="preset-button" @click="applyPreset('retro')">Retro Vibes</button>
                    <!-- Professional Themes -->
                    <button class="preset-button" @click="applyPreset('corporate')">Corporate</button>
                    <button class="preset-button" @click="applyPreset('tech')">Tech Terminal</button>
                    <button class="preset-button" @click="applyPreset('medical')">Medical Clean</button>
                    <button class="preset-button" @click="applyPreset('legal')">Legal Brief</button>
                    <button class="preset-button" @click="applyPreset('finance')">Finance Pro</button>

                    <!-- Creative Themes -->
                    <button class="preset-button" @click="applyPreset('artistic')">Artistic Portfolio</button>
                    <button class="preset-button" @click="applyPreset('writer')">Writer's Journal</button>
                    <button class="preset-button" @click="applyPreset('photographer')">Photographer</button>
                    <button class="preset-button" @click="applyPreset('musician')">Musician Stage</button>
                    <button class="preset-button" @click="applyPreset('scifi')">Sci-Fi Universe</button>

                    <!-- Niche Themes -->
                    <button class="preset-button" @click="applyPreset('food')">Food Blog</button>
                    <button class="preset-button" @click="applyPreset('travel')">Travel Explorer</button>
                    <button class="preset-button" @click="applyPreset('fashion')">Fashion Forward</button>
                    <button class="preset-button" @click="applyPreset('gaming')">Gaming Zone</button>
                    <button class="preset-button" @click="applyPreset('educational')">Educational Hub</button>

                    <!-- Unique/Experimental Themes -->
                    <button class="preset-button" @click="applyPreset('cyberpunk')">Cyberpunk Edge</button>
                    <button class="preset-button" @click="applyPreset('vaporwave')">Vaporwave Aesthetic</button>
                    <button class="preset-button" @click="applyPreset('brutalist')">Brutalist Raw</button>
                    <button class="preset-button" @click="applyPreset('handwritten')">Handwritten Notes</button>
                    <button class="preset-button" @click="applyPreset('vintage')">Vintage Paper</button>

                    <!-- Additional Theme -->
                    <button class="preset-button" @click="applyPreset('podcast')">Podcast Studio</button>
                    <button class="preset-button" @click="applyPreset('minimalist')">Minimalist Focus</button>


                </div>
            </div>
            
            <div class="controls-footer">
                <button class="export-button" @click="updatePreview">
                    <i class="fas fa-refresh"></i> Refresh Preview
                </button>
            </div>
        </div>
        
        <div class="preview" :class="{'responsive-mode': responsivePreview.enabled}">
            <div class="device-wrapper" v-if="responsivePreview.enabled" :class="'device-' + responsivePreview.device">
              <iframe ref="previewFrame"></iframe>
            </div>
            <iframe v-else ref="previewFrame"></iframe>
            <div v-if="isLoading" class="loading">
              <div class="spinner"></div>
            </div>
        </div>
    </div>
    
    <script>
        const ALL_GOOGLE_FONTS = [
            {family: 'Roboto', category: 'sans-serif'},
            {family: 'Open Sans', category: 'sans-serif'},
            {family: 'Lato', category: 'sans-serif'},
            {family: 'Montserrat', category: 'sans-serif'},
            {family: 'Roboto Condensed', category: 'sans-serif'},
            {family: 'Source Sans Pro', category: 'sans-serif'},
            {family: 'Oswald', category: 'sans-serif'},
            {family: 'Raleway', category: 'sans-serif'},
            {family: 'Ubuntu', category: 'sans-serif'},
            {family: 'Merriweather', category: 'serif'},
            {family: 'PT Sans', category: 'sans-serif'},
            {family: 'Roboto Slab', category: 'serif'},
            {family: 'Playfair Display', category: 'serif'},
            {family: 'Lora', category: 'serif'},
            {family: 'Poppins', category: 'sans-serif'},
            {family: 'Noto Sans', category: 'sans-serif'},
            {family: 'Nunito', category: 'sans-serif'},
            {family: 'Quicksand', category: 'sans-serif'},
            {family: 'Work Sans', category: 'sans-serif'},
            {family: 'Fira Sans', category: 'sans-serif'},
            {family: 'PT Serif', category: 'serif'},
            {family: 'Nunito Sans', category: 'sans-serif'},
            {family: 'Rubik', category: 'sans-serif'},
            {family: 'Noto Serif', category: 'serif'},
            {family: 'Crimson Text', category: 'serif'},
            {family: 'Libre Baskerville', category: 'serif'},
            {family: 'Arvo', category: 'serif'},
            {family: 'Bitter', category: 'serif'},
            {family: 'Karla', category: 'sans-serif'},
            {family: 'Cabin', category: 'sans-serif'},
            {family: 'Josefin Sans', category: 'sans-serif'},
            {family: 'IBM Plex Sans', category: 'sans-serif'},
            {family: 'Source Code Pro', category: 'monospace'},
            {family: 'Fira Code', category: 'monospace'},
            {family: 'Inconsolata', category: 'monospace'},
            {family: 'Courier Prime', category: 'monospace'},
            {family: 'Space Mono', category: 'monospace'},
            {family: 'Dancing Script', category: 'handwriting'},
            {family: 'Pacifico', category: 'handwriting'},
            {family: 'Caveat', category: 'handwriting'},
            {family: 'Permanent Marker', category: 'handwriting'},
            {family: 'Indie Flower', category: 'handwriting'},
            {family: 'Shadows Into Light', category: 'handwriting'},
            {family: 'Architects Daughter', category: 'handwriting'},
            {family: 'Bangers', category: 'display'},
            {family: 'Fredoka One', category: 'display'},
            {family: 'Lobster', category: 'display'},
            {family: 'Righteous', category: 'display'},
            {family: 'Anton', category: 'display'},
            {family: 'Abril Fatface', category: 'display'},
            {family: 'Archivo', category: 'sans-serif'},
            {family: 'Comfortaa', category: 'display'},
            {family: 'Questrial', category: 'sans-serif'},
            {family: 'Alegreya', category: 'serif'},
            {family: 'Exo 2', category: 'sans-serif'},
            {family: 'Cormorant Garamond', category: 'serif'},
            {family: 'DM Sans', category: 'sans-serif'},
            {family: 'Manrope', category: 'sans-serif'},
            {family: 'Philosopher', category: 'sans-serif'},
            {family: 'Cardo', category: 'serif'},
            {family: 'Spectral', category: 'serif'},
            {family: 'EB Garamond', category: 'serif'},
            {family: 'Domine', category: 'serif'},
            {family: 'Vollkorn', category: 'serif'},
            {family: 'Prompt', category: 'sans-serif'},
            {family: 'Barlow', category: 'sans-serif'},
            {family: 'Inter', category: 'sans-serif'},
            {family: 'Archivo Narrow', category: 'sans-serif'},
            {family: 'Cinzel', category: 'serif'},
            {family: 'Mulish', category: 'sans-serif'},
            {family: 'Didact Gothic', category: 'sans-serif'},
            {family: 'Varela Round', category: 'sans-serif'},
            {family: 'Heebo', category: 'sans-serif'},
            {family: 'Martel', category: 'serif'},
            {family: 'Asap', category: 'sans-serif'},
            {family: 'Oxygen', category: 'sans-serif'},
            {family: 'Overpass', category: 'sans-serif'},
            {family: 'Quattrocento', category: 'serif'},
            {family: 'Red Hat Display', category: 'sans-serif'},
            {family: 'Tinos', category: 'serif'},
            {family: 'Lexend Deca', category: 'sans-serif'},
            {family: 'Jost', category: 'sans-serif'},
            {family: 'Catamaran', category: 'sans-serif'},
            {family: 'Saira', category: 'sans-serif'},
            {family: 'Encode Sans', category: 'sans-serif'},
            {family: 'Public Sans', category: 'sans-serif'},
            {family: 'Assistant', category: 'sans-serif'},
            {family: 'IBM Plex Serif', category: 'serif'},
            {family: 'Sen', category: 'sans-serif'},
            {family: 'Sora', category: 'sans-serif'},
            {family: 'Outfit', category: 'sans-serif'},
            {family: 'Figtree', category: 'sans-serif'},
            {family: 'League Spartan', category: 'sans-serif'},
            {family: 'Geologica', category: 'sans-serif'},
            {family: 'Urbanist', category: 'sans-serif'},
            {family: 'Playfair Display SC', category: 'serif'},
            {family: 'Rufina', category: 'serif'},
            {family: 'Bodoni Moda', category: 'serif'},
            {family: 'Cormorant', category: 'serif'},
            {family: 'Fraunces', category: 'serif'},
            {family: 'Marcellus', category: 'serif'},
            {family: 'Lemon', category: 'display'},
            {family: 'Bungee', category: 'display'},
            {family: 'Londrina Solid', category: 'display'},
            {family: 'Alfa Slab One', category: 'display'},
            {family: 'Yeseva One', category: 'display'},
            {family: 'Amatic SC', category: 'handwriting'},
            {family: 'Patrick Hand', category: 'handwriting'},
            {family: 'Kalam', category: 'handwriting'},
            {family: 'Sacramento', category: 'handwriting'},
            {family: 'Satisfy', category: 'handwriting'}
        ];
        
        const COLOR_PALETTES = [
            {c1: '#f8f9fa', c2: '#e9ecef', name: 'Light Gray'},
            {c1: '#212529', c2: '#343a40', name: 'Dark Gray'},
            {c1: '#339af0', c2: '#1c7ed6', name: 'Blue'},
            {c1: '#51cf66', c2: '#37b24d', name: 'Green'},
            {c1: '#fcc419', c2: '#f59f00', name: 'Yellow'},
            {c1: '#ff6b6b', c2: '#fa5252', name: 'Red'},
            {c1: '#cc5de8', c2: '#ae3ec9', name: 'Purple'},
            {c1: '#20c997', c2: '#12b886', name: 'Teal'},
            {c1: '#ff922b', c2: '#f76707', name: 'Orange'},
            {c1: '#5f3dc4', c2: '#4c3299', name: 'Indigo'},
            {c1: '#f783ac', c2: '#e64980', name: 'Pink'},
            {c1: '#2f9e44', c2: '#2b8a3e', name: 'Forest'},
            {c1: '#1864ab', c2: '#1971c2', name: 'Navy'},
            {c1: '#e67700', c2: '#d9480f', name: 'Amber'},
            {c1: '#9c36b5', c2: '#862e9c', name: 'Violet'}
        ];
        
        new Vue({
            el: '#app',
            data: {
                activeTab: 'design',
                isLoading: false,
                bodyFontSearch: '',
                headingFontSearch: '',
                showBodyFonts: false,
                showHeadingFonts: false,
                collapsedGroups: {
                    contentSource: false,
                    background: false,
                    page: false,
                    typography: false,
                    hero: false,
                    images: false,
                    sections: false,
                    blockquote: true,
                    table: true,
                    list: true,
                    imageLinks: false,
                    advanced: true
                },
                wikiSearch: '',
                wikiSearchTimeout: null,
                wikiSearching: false,
                wikiError: null,
                wikiResults: [],
                currentWikiArticle: null,
                wikiContent: null,
                loremTextCache: null,
                p: {
                    content: {
                        source: 'lorem',
                        loremParagraphs: 6,
                        loremImages: 3,
                        loremHeadings: 3
                    },
                    bg: {
                        c1: '#f8f9fa',
                        c2: '#e9ecef',
                        style: 'gradient',
                        patternSize: 20
                    },
                    page: {
                        enabled: true,
                        bgColor: '#ffffff',
                        shadowSize: 10,
                        borderSize: 1,
                        borderColor: '#dee2e6',
                        paddingX: 40,
                        paddingY: 40,
                        maxWidth: 800,
                        borderRadius: 0
                    },
                    type: {
                        bodyFont: "'Roboto', sans-serif",
                        headingFont: "'Roboto', sans-serif",
                        lineHeight: 1.6,
                        titleColor: '#212529',
                        titleSize: 42,
                        titleStyle: 'normal',
                        titleAlign: 'left',
                        titlePaddingX: 0,
                        titlePaddingY: 0,
                        titleSpaceBelow: 30,
                        headingColor: '#343a40',
                        headingSize: 28,
                        headingStyle: 'normal',
                        headingSpaceAbove: 30,
                        headingSpaceBelow: 20,
                        textColor: '#495057',
                        textSize: 16,
                        linkColor: '#0d6efd',
                        linkHoverColor: '#0a58ca',
                        linkUnderline: true,
                        linkHoverEffect: 'none'
                    },
                    hero: {
                        enabled: true,
                        type: 'color',
                        c1: '#4dabf7',
                        c2: '#228be6',
                        style: 'gradient',
                        paddingX: 40,
                        paddingY: 60,
                        borderRadius: 0,
                        imageUrl: '',
                        placeholderWidth: 1200,
                        overlayColor: '#000000',
                        overlayOpacity: 0.3,
                        titleEffect: 'none'
                    },
                    img: {
                        borderSize: 2,
                        borderColor: '#dee2e6',
                        padding: 10,
                        captionSize: 14,
                        borderRadius: 4,
                        style: 'normal',
                        hoverEffect: 'none',
                        displayWidth: 'normal'
                    },
                    section: {
                        color: '#dee2e6',
                        size: 2,
                        style: 'solid',
                        symbol: '•',
                        margin: 40
                    },
                    blockquote: {
                        borderSize: 3,
                        borderColor: '#dee2e6',
                        borderPosition: 'left',
                        backgroundColor: '#f8f9fa',
                        textColor: '',  // Empty means inherit from body
                        fontStyle: 'normal', // normal, italic
                        padding: 20,
                        quoteMarks: false,
                    },
                    table: {
                        borderSize: 1,
                        borderColor: '#dee2e6',
                        headerBackground: '#f8f9fa',
                        headerTextColor: '#212529',
                        alternateRows: true,
                        alternateColor: '#f8f9fa',
                    },
                    list: {
                        bulletColor: '',  // Empty means inherit
                        bulletStyle: 'default', // default, custom, none
                        bulletSymbol: '•',
                        indentation: 20,
                        spacing: 8,
                    },
                    advanced: {
                        contentWidth: 100,
                        paragraphIndent: 0,
                        paragraphSpacing: 20,
                        customCSS: ''
                    },
                    imageLinks: {
                        borderSize: 2,
                        borderColor: '#dee2e6',
                        borderRadius: 6,
                        captionSize: 14,
                        captionColor: '#495057',
                        style: 'shadow',
                        hoverEffect: 'lift',
                        layout: 'grid',
                        itemsPerRow: 3,
                        displayStyle: 'standard', // new option for display style
                        imagePosition: 'top',     // for list layouts
                        spacing: 20              // spacing between items
                    },
                },
                
                colorPalettes: COLOR_PALETTES,
                responsivePreview: {
                    enabled: false,
                    device: 'desktop', // 'desktop', 'tablet', 'mobile'
                    sizes: {
                        desktop: { width: '100%', height: '100%' },
                        tablet: { width: '768px', height: '1024px' },
                        mobile: { width: '375px', height: '667px' }
                    }
                },
            },

            computed: {
                filteredBodyFonts() {
                    if (!this.bodyFontSearch) return ALL_GOOGLE_FONTS.slice(0, 20); // Show top 20 by default
                    const searchLower = this.bodyFontSearch.toLowerCase();
                    return ALL_GOOGLE_FONTS.filter(font => 
                        font.family.toLowerCase().includes(searchLower)
                    );
                },
                
                groupedBodyFonts() {
                    return this.groupFontsByCategory(this.filteredBodyFonts);
                },
                
                filteredHeadingFonts() {
                    if (!this.headingFontSearch) return ALL_GOOGLE_FONTS.slice(0, 20); // Show top 20 by default
                    const searchLower = this.headingFontSearch.toLowerCase();
                    return ALL_GOOGLE_FONTS.filter(font => 
                        font.family.toLowerCase().includes(searchLower)
                    );
                },
                
                groupedHeadingFonts() {
                    return this.groupFontsByCategory(this.filteredHeadingFonts);
                },
                
                css() {
                    return [
                        this.bgCSS(),
                        this.pageCSS(),
                        this.typeCSS(),
                        this.heroCSS(),
                        this.imgCSS(),
                        this.sectionCSS(),
                        this.blockquoteCSS(),
                        this.tableCSS(),
                        this.listCSS(),
                        this.imageLinkCSS(),
                        this.advancedCSS()
                    ].join('');
                },
                
                loadedFonts() {
                    // Get unique fonts that need to be loaded
                    const bodyFont = this.p.type.bodyFont.split("'")[1];
                    const headingFont = this.p.type.headingFont.split("'")[1];
                    
                    let fontList = [bodyFont];
                    if (headingFont !== bodyFont) {
                        fontList.push(headingFont);
                    }
                    
                    return fontList.map(font => 
                        `https://fonts.googleapis.com/css2?family=${font.replace(/ /g, '+')}:wght@400;700&display=swap`
                    );
                }
            },
            methods: {

                // Add this utility method
                debounce(func, wait) {
                    let timeout;
                    return function() {
                        const context = this;
                        const args = arguments;
                        clearTimeout(timeout);
                        timeout = setTimeout(() => {
                            func.apply(context, args);
                        }, wait);
                    };
                },

                toggleGroup(groupName) {
                    this.collapsedGroups[groupName] = !this.collapsedGroups[groupName];
                },
                
                selectBodyFont(font) {
                    this.p.type.bodyFont = `'${font.family}', ${font.category}`;
                    this.bodyFontSearch = '';
                    this.showBodyFonts = false;
                    this.updatePreview();
                },
                
                selectHeadingFont(font) {
                    this.p.type.headingFont = `'${font.family}', ${font.category}`;
                    this.headingFontSearch = '';
                    this.showHeadingFonts = false;
                    this.updatePreview();
                },
                
                groupFontsByCategory(fonts) {
                    const grouped = {};
                    fonts.forEach(font => {
                        if (!grouped[font.category]) {
                            grouped[font.category] = [];
                        }
                        grouped[font.category].push(font);
                    });
                    return grouped;
                },
                
                setContentSource(source) {
                    this.p.content.source = source;
                    if (source === 'lorem' && !this.loremTextCache) {
                        this.generateLoremTextCache();
                    }
                    this.updatePreview();
                },
                
                generateLoremTextCache() {
                    // Generate and cache lorem text so it doesn't change when design changes
                    const paragraphs = [];
                    
                    // First paragraph always starts with the requested text
                    paragraphs.push("Sphinx of black quartz, judge my vow! " + this.getLoremText());
                    
                    // Generate remaining paragraphs
                    for (let i = 1; i < 20; i++) {
                        paragraphs.push(this.getLoremText());
                    }
                    
                    this.loremTextCache = paragraphs;
                },
                
                generateNewLorem() {
                    this.loremTextCache = null;
                    this.generateLoremTextCache();
                    this.updatePreview();
                },
                
                debouncedWikiSearch() {
                    clearTimeout(this.wikiSearchTimeout);
                    this.wikiSearchTimeout = setTimeout(() => {
                        if (this.wikiSearch.length > 2) {
                            this.searchWikipedia(this.wikiSearch);
                        } else {
                            this.wikiResults = [];
                        }
                    }, 500);
                },
                
                async searchWikipedia(query) {
                    this.wikiSearching = true;
                    this.wikiError = null;
                    
                    try {
                        const url = `https://en.wikipedia.org/w/api.php?action=query&list=search&srsearch=${encodeURIComponent(query)}&format=json&origin=*`;
                        const response = await fetch(url);
                        const data = await response.json();
                        
                        if (data.query && data.query.search) {
                            this.wikiResults = data.query.search;
                        } else {
                            this.wikiResults = [];
                            this.wikiError = "No results found";
                        }
                    } catch (error) {
                        this.wikiError = "Error searching Wikipedia: " + error.message;
                        this.wikiResults = [];
                    } finally {
                        this.wikiSearching = false;
                    }
                },
                
                selectWikiArticle(article) {
                    this.currentWikiArticle = article;
                    this.wikiResults = [];
                },
                
                async fetchWikiArticleContent() {
                    if (!this.currentWikiArticle) return;
                    
                    this.isLoading = true;
                    
                    try {
                        // Fetch article extract
                        const extractUrl = `https://en.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(this.currentWikiArticle.title)}`;
                        const extractResponse = await fetch(extractUrl);
                        const extractData = await extractResponse.json();
                        
                        // Get content from sections API
                        const sectionsUrl = `https://en.wikipedia.org/api/rest_v1/page/mobile-sections/${encodeURIComponent(this.currentWikiArticle.title)}`;
                        const sectionsResponse = await fetch(sectionsUrl);
                        const sectionsData = await sectionsResponse.json();
                        
                        // Process content
                        this.wikiContent = {
                            title: extractData.title,
                            extract: extractData.extract,
                            thumbnail: extractData.thumbnail?.source,
                            sections: sectionsData.remaining.sections
                        };
                        
                        this.updatePreview();
                    } catch (error) {
                        this.wikiError = "Error fetching Wikipedia content: " + error.message;
                    } finally {
                        this.isLoading = false;
                    }
                },
                
                bgCSS() {
                    const { c1, c2, style, patternSize } = this.p.bg;
                    let css = 'body {\n';
                    
                    switch (style) {
                        case 'solid':
                            css += `  background-color: ${c1};\n`;
                            break;
                        case 'gradient':
                            css += `  background: linear-gradient(135deg, ${c1}, ${c2});\n`;
                            break;
                        case 'circles':
                            css += `  background-color: ${c1};\n  background-image: radial-gradient(circle at 25% 25%, ${c2} 5%, transparent 40%), radial-gradient(circle at 75% 75%, ${c2} 5%, transparent 40%);\n`;
                            break;
                        case 'squares':
                            css += `  background-color: ${c1};\n  background-image: linear-gradient(45deg, ${c2} 25%, transparent 25%), linear-gradient(-45deg, ${c2} 25%, transparent 25%), linear-gradient(45deg, transparent 75%, ${c2} 75%), linear-gradient(-45deg, transparent 75%, ${c2} 75%);\n  background-size: ${patternSize}px ${patternSize}px;\n  background-position: 0 0, 0 ${patternSize/2}px, ${patternSize/2}px -${patternSize/2}px, -${patternSize/2}px 0px;\n`;
                            break;
                        case 'polkadots':
                            css += `  background-color: ${c1};\n  background-image: radial-gradient(${c2} ${patternSize/6}px, transparent ${patternSize/6}px);\n  background-size: ${patternSize}px ${patternSize}px;\n  background-position: 0 0, ${patternSize/2}px ${patternSize/2}px;\n`;
                            break;
                        case 'stripes':
                            css += `  background: repeating-linear-gradient(45deg, ${c1}, ${c1} ${patternSize/2}px, ${c2} ${patternSize/2}px, ${c2} ${patternSize}px);\n`;
                            break;
                        case 'triangles':
                            css += `  background-color: ${c1};\n  background-image: linear-gradient(45deg, ${c2} 25%, transparent 25%), linear-gradient(135deg, ${c2} 25%, transparent 25%);\n  background-size: ${patternSize}px ${patternSize}px;\n`;
                            break;
                        case 'zigzag':
                            css += `  background-color: ${c1};\n  background-image: linear-gradient(135deg, ${c2} 25%, transparent 25%), linear-gradient(225deg, ${c2} 25%, transparent 25%);\n  background-size: ${patternSize}px ${patternSize}px;\n  background-position: 0 0, ${patternSize/2}px 0;\n`;
                            break;
                        case 'noise':
                            css += `  background-color: ${c1};\n  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");\n  background-blend-mode: multiply;\n`;
                            break;
                        case 'wave':
                            css += `  background: linear-gradient(135deg, ${c1}, ${c2});\n  background-image: repeating-radial-gradient(ellipse at 50% 100%, transparent, transparent ${patternSize*2}px, rgba(255, 255, 255, 0.1) ${patternSize*2+10}px, rgba(255, 255, 255, 0.1) ${patternSize*3}px);\n`;
                            break;
                    }
                    
                    css += '  margin: 0;\n  padding: 0;\n  min-height: 100vh;\n}\n\n';
                    return css;
                },
                
                pageCSS() {
                    const { enabled, bgColor, shadowSize, borderSize, borderColor, 
                           paddingX, paddingY, maxWidth, borderRadius } = this.p.page;
                    let css = '.page-container {\n';
                    
                    css += `  max-width: ${maxWidth}px;\n  margin: 40px auto;\n`;
                    
                    if (enabled) {
                        css += `  background-color: ${bgColor};\n`;
                        
                        if (borderRadius > 0) {
                            css += `  border-radius: ${borderRadius}px;\n`;
                        }
                        
                        if (shadowSize > 0) {
                            css += `  box-shadow: 0 0 ${shadowSize}px rgba(0, 0, 0, 0.2);\n`;
                        }
                        
                        if (borderSize > 0) {
                            css += `  border: ${borderSize}px solid ${borderColor};\n`;
                        }
                    }
                    
                    css += '  overflow: hidden;\n}\n\n';
                    css += `.content {\n  padding: ${paddingY}px ${paddingX}px;\n}\n\n`;
                    return css;
                },
                
                typeCSS() {
                    const { bodyFont, headingFont, lineHeight, titleColor, titleSize, titleStyle, titleAlign, 
                           titlePaddingX, titlePaddingY, titleSpaceBelow, 
                           headingColor, headingSize, headingStyle, headingSpaceAbove, headingSpaceBelow, 
                           textColor, textSize, linkColor, linkHoverColor, linkUnderline, linkHoverEffect } = this.p.type;
                    let css = '';
                    
                    css += `body {\n  font-family: ${bodyFont};\n  color: ${textColor};\n  font-size: ${textSize}px;\n  line-height: ${lineHeight};\n}\n\n`;
                    
                    // Common styles for headings
                    css += `h1, h2, h3, h4, h5, h6 {\n  font-family: ${headingFont};\n}\n\n`;
                    
                    // Title styles
                    css += `.post-title {\n  color: ${titleColor};\n  font-size: ${titleSize}px;\n  margin-bottom: ${titleSpaceBelow}px;\n  font-weight: bold;\n  padding: ${titlePaddingY}px ${titlePaddingX}px;\n  text-align: ${titleAlign};\n`;
                    
                    switch (titleStyle) {
                        case 'underline':
                            css += `  border-bottom: 2px solid ${titleColor};\n  padding-bottom: 8px;\n`;
                            break;
                        case 'highlight':
                            css += `  background: linear-gradient(to bottom, transparent 50%, rgba(${this.hexToRgb(titleColor)}, 0.2) 50%);\n  display: inline-block;\n  padding: ${titlePaddingY}px ${titlePaddingX + 5}px;\n`;
                            break;
                        case 'bordered':
                            css += `  border: 2px solid ${titleColor};\n  padding: ${titlePaddingY + 10}px ${titlePaddingX + 10}px;\n`;
                            break;
                        case 'shadow':
                            css += `  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);\n`;
                            break;
                        case 'gradient':
                            css += `  background: linear-gradient(135deg, ${titleColor}, ${this.lightenColor(titleColor, 20)});\n  -webkit-background-clip: text;\n  -webkit-text-fill-color: transparent;\n  background-clip: text;\n  text-fill-color: transparent;\n`;
                            break;
                    }
                    
                    css += '}\n\n';
                    
                    // Heading styles
                    css += `h2, h3, h4, h5, h6 {\n  color: ${headingColor};\n  margin-top: ${headingSpaceAbove}px;\n  margin-bottom: ${headingSpaceBelow}px;\n}\n\n`;
                    
                    css += `h2 {\n  font-size: ${headingSize}px;\n`;
                    
                    switch (headingStyle) {
                        case 'underline':
                            css += `  border-bottom: 1px solid ${headingColor};\n  padding-bottom: 5px;\n`;
                            break;
                        case 'highlight':
                            css += `  background: linear-gradient(to bottom, transparent 60%, rgba(${this.hexToRgb(headingColor)}, 0.15) 40%);\n  display: inline-block;\n  padding: 0 5px;\n`;
                            break;
                        case 'leftBorder':
                            css += `  border-left: 4px solid ${headingColor};\n  padding-left: 10px;\n`;
                            break;
                        case 'gradient':
                            css += `  background: linear-gradient(90deg, ${headingColor}, ${this.lightenColor(headingColor, 20)});\n  -webkit-background-clip: text;\n  -webkit-text-fill-color: transparent;\n  background-clip: text;\n  text-fill-color: transparent;\n`;
                            break;
                    }
                    css += '}\n\n';
                    
                    css += `h3 {\n  font-size: ${Math.round(headingSize * 0.85)}px;\n}\n\n`;
                    css += `h4 {\n  font-size: ${Math.round(headingSize * 0.7)}px;\n}\n\n`;
                    
                    css += `p {\n  margin-bottom: ${this.p.advanced.paragraphSpacing}px;\n`;
                    if (this.p.advanced.paragraphIndent > 0) {
                        css += `  text-indent: ${this.p.advanced.paragraphIndent}px;\n`;
                    }
                    css += '}\n\n';
                    
                    // Link styles
                    css += `a {\n  color: ${linkColor};\n  text-decoration: ${linkUnderline ? 'underline' : 'none'};\n  transition: all 0.2s ease;\n}\n\n`;
                    
                    css += `a:hover {\n  color: ${linkHoverColor};\n`;
                    
                    switch (linkHoverEffect) {
                        case 'underline':
                            css += `  text-decoration: underline;\n`;
                            break;
                        case 'highlight':
                            css += `  background-color: rgba(${this.hexToRgb(linkColor)}, 0.1);\n`;
                            break;
                        case 'bold':
                            css += `  font-weight: bold;\n`;
                            break;
                    }
                    
                    css += '}\n\n';
                    
                    return css;
                },
                
                heroCSS() {
                    const { enabled, type, c1, c2, style, paddingX, paddingY, borderRadius, 
                           imageUrl, overlayColor, overlayOpacity, titleEffect } = this.p.hero;
                    let css = '';
                    
                    if (enabled) {
                        css += '.hero-panel {\n';
                        css += `  padding: ${paddingY}px ${paddingX}px;\n`;
                        css += '  position: relative;\n';
                        
                        if (borderRadius > 0) {
                            css += `  border-radius: ${borderRadius}px ${borderRadius}px 0 0;\n`;
                        }
                        
                        if (type === 'color') {
                            switch (style) {
                                case 'solid':
                                    css += `  background-color: ${c1};\n`;
                                    break;
                                case 'gradient':
                                    css += `  background: linear-gradient(135deg, ${c1}, ${c2});\n`;
                                    break;
                                case 'radial':
                                    css += `  background: radial-gradient(circle, ${c1}, ${c2});\n`;
                                    break;
                                case 'angled':
                                    css += `  background-color: ${c1};\n`;
                                    css += `  z-index: 1;\n`;
                                    css += `}\n\n.hero-panel::after {\n`;
                                    css += `  content: '';\n`;
                                    css += `  position: absolute;\n`;
                                    css += `  bottom: 0;\n`;
                                    css += `  left: 0;\n`;
                                    css += `  width: 100%;\n`;
                                    css += `  height: 30%;\n`;
                                    css += `  background-color: ${c2};\n`;
                                    css += `  transform: skewY(-3deg);\n`;
                                    css += `  transform-origin: top left;\n`;
                                    css += `  z-index: -1;\n`;
                                    break;
                                case 'wave':
                                    css += `  background: ${c1};\n`;
                                    css += `}\n\n.hero-panel::after {\n`;
                                    css += `  content: '';\n`;
                                    css += `  position: absolute;\n`;
                                    css += `  bottom: -20px;\n`;
                                    css += `  left: 0;\n`;
                                    css += `  width: 100%;\n`;
                                    css += `  height: 40px;\n`;
                                    css += `  background: ${c1};\n`;
                                    css += `  clip-path: polygon(0% 0%, 5% 40%, 10% 0%, 15% 40%, 20% 0%, 25% 40%, 30% 0%, 35% 40%, 40% 0%, 45% 40%, 50% 0%, 55% 40%, 60% 0%, 65% 40%, 70% 0%, 75% 40%, 80% 0%, 85% 40%, 90% 0%, 95% 40%, 100% 0%, 100% 100%, 0% 100%);\n`;
                                    break;
                            }
                        } else if (type === 'image') {
                            let imgUrl = imageUrl;
                            if (!imgUrl) {
                                const width = this.p.hero.placeholderWidth;
                                const height = Math.round(width / 2);
                                imgUrl = `https://picsum.photos/${width}/${height}?random=hero`;
                            }
                            
                            css += `  background-image: url("${imgUrl}");\n`;
                            css += `  background-size: cover;\n`;
                            css += `  background-position: center;\n`;
                            css += `}\n\n.hero-panel::before {\n`;
                            css += `  content: '';\n`;
                            css += `  position: absolute;\n`;
                            css += `  top: 0;\n`;
                            css += `  left: 0;\n`;
                            css += `  width: 100%;\n`;
                            css += `  height: 100%;\n`;
                            css += `  background-color: ${overlayColor};\n`;
                            css += `  opacity: ${overlayOpacity};\n`;
                            css += `  z-index: 1;\n`;
                        }
                        
                        if ((type === 'color' && style !== 'angled' && style !== 'wave') || type === 'image') {
                            css += '}\n\n';
                        }
                        
                        css += '.hero-panel .post-title {\n';
                        css += '  margin-bottom: 0;\n';
                        
                        if (type === 'image') {
                            css += '  position: relative;\n';
                            css += '  z-index: 2;\n';
                        }
                        // Title text effects for better readability 
                        switch (titleEffect) {
                            case 'shadow':
                                css += '  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.6);\n';
                                break;
                            case 'glow':
                                css += '  text-shadow: 0 0 10px rgba(255, 255, 255, 0.8), 0 0 20px rgba(255, 255, 255, 0.6), 0 0 30px rgba(255, 255, 255, 0.4);\n';
                                break;
                            case 'outline':
                                css += '  text-shadow: -1px -1px 0 rgba(0, 0, 0, 0.7), 1px -1px 0 rgba(0, 0, 0, 0.7), -1px 1px 0 rgba(0, 0, 0, 0.7), 1px 1px 0 rgba(0, 0, 0, 0.7);\n';
                                break;
                            case 'contrast':
                                css += '  background-color: rgba(0, 0, 0, 0.5);\n';
                                css += '  padding: 10px;\n';
                                css += '  display: inline-block;\n';
                                break;
                            default:
                                // No effect
                                break;
                        }
                        
                        if (type === 'color' && (style === 'angled' || style === 'wave')) {
                            css += '  position: relative;\n';
                            css += '  z-index: 2;\n';
                        }
                        
                        css += '}\n\n';
                    }
                    
                    return css;
                },
                
                imgCSS() {
                    const { borderSize, borderColor, padding, captionSize, borderRadius, style, hoverEffect, displayWidth } = this.p.img;
                    let css = '.image-container {\n  margin-bottom: 30px;\n  text-align: center;\n';
                    
                    // Handle display width options
                    switch (displayWidth) {
                        case 'normal':
                            css += '  width: 100%;\n';
                            break;
                        case 'wide':
                            css += '  width: 110%;\n';
                            css += '  margin-left: -5%;\n';
                            break;
                        case 'full':
                            css += '  width: 100vw;\n';
                            css += '  margin-left: calc(-50vw + 50%);\n';
                            break;
                        case 'breakout':
                            css += '  width: calc(100% + 80px);\n';
                            css += '  margin-left: -40px;\n';
                            break;
                    }
                    
                    css += '}\n\n';
                    
                    css += '.image-container img {\n  max-width: 100%;\n';
                    
                    if (style === 'normal' || style === 'shadow') {
                        if (borderSize > 0) css += `  border: ${borderSize}px solid ${borderColor};\n`;
                    }
                    
                    if (padding > 0) css += `  padding: ${padding}px;\n`;
                    if (borderRadius > 0) css += `  border-radius: ${borderRadius}px;\n`;
                    
                    // Add transition for hover effects
                    if (hoverEffect !== 'none') {
                        css += '  transition: all 0.3s ease;\n';
                    }
                    
                    switch (style) {
                        case 'shadow':
                            css += '  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);\n';
                            break;
                        case 'polaroid':
                            css += '  border: 10px solid white;\n';
                            css += '  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);\n';
                            css += '  transform: rotate(1deg);\n';
                            break;
                        case 'lifted':
                            css += '  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);\n';
                            css += '  position: relative;\n';
                            css += '}\n\n';
                            css += '.image-container img::before,\n.image-container img::after {\n';
                            css += '  content: "";\n';
                            css += '  position: absolute;\n';
                            css += '  z-index: -1;\n';
                            css += '  bottom: 15px;\n';
                            css += '  width: 50%;\n';
                            css += '  height: 20%;\n';
                            css += '  box-shadow: 0 15px 10px rgba(0, 0, 0, 0.3);\n';
                            css += '}\n\n';
                            css += '.image-container img::before {\n';
                            css += '  left: 10px;\n';
                            css += '  transform: rotate(-3deg);\n';
                            css += '}\n\n';
                            css += '.image-container img::after {\n';
                            css += '  right: 10px;\n';
                            css += '  transform: rotate(3deg);\n';
                            break;
                        case 'frame':
                            css += '  border: 12px solid #f8f8f8;\n';
                            css += '  box-shadow: 0 0 0 1px #ccc, 0 0 10px rgba(0, 0, 0, 0.2);\n';
                            css += '  padding: 5px;\n';
                            break;
                    }
                    
                    if (style !== 'lifted') {
                        css += '}\n\n';
                    }
                    
                    // Add hover effects
                    if (hoverEffect !== 'none') {
                        css += '.image-container img:hover {\n';
                        
                        switch (hoverEffect) {
                            case 'zoom':
                                css += '  transform: scale(1.05);\n';
                                break;
                            case 'brighten':
                                css += '  filter: brightness(1.1);\n';
                                break;
                            case 'saturate':
                                css += '  filter: saturate(1.5);\n';
                                break;
                            case 'lift':
                                css += '  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);\n';
                                css += '  transform: translateY(-5px);\n';
                                break;
                        }
                        
                        css += '}\n\n';
                    }
                    
                    css += `.image-caption {\n  text-align: center;\n  font-style: italic;\n  font-size: ${captionSize}px;\n  margin-top: 10px;\n  color: ${this.darkenColor(this.p.type.textColor, 20)};\n}\n\n`;
                    
                    return css;
                },
                
                blockquoteCSS() {
                    const { borderSize, borderColor, borderPosition, backgroundColor, 
                            textColor, fontStyle, padding, quoteMarks } = this.p.blockquote;
                    let css = 'blockquote {\n';
                    
                    // Background and padding
                    css += `  background-color: ${backgroundColor};\n`;
                    css += `  padding: ${padding}px;\n`;
                    
                    // Border
                    if (borderPosition === 'all') {
                        css += `  border: ${borderSize}px solid ${borderColor};\n`;
                    } else {
                        css += `  border: none;\n`;
                        css += `  border-${borderPosition}: ${borderSize}px solid ${borderColor};\n`;
                    }
                    
                    // Text styling
                    if (textColor) {
                        css += `  color: ${textColor};\n`;
                    }
                    
                    if (fontStyle === 'italic') {
                        css += '  font-style: italic;\n';
                    }
                    
                    css += '  margin: 20px 0;\n';
                    
                    // Quote marks
                    if (quoteMarks) {
                        css += '  position: relative;\n';
                        css += '}\n\n';
                        css += 'blockquote::before {\n';
                        css += '  content: "\\201C";\n';
                        css += '  font-size: 4em;\n';
                        css += '  position: absolute;\n';
                        css += '  left: 10px;\n';
                        css += '  top: -10px;\n';
                        css += `  color: ${borderColor};\n`;
                        css += '  opacity: 0.5;\n';
                    }
                    
                    css += '}\n\n';
                    return css;
                },

                tableCSS() {
                    const { borderSize, borderColor, headerBackground, 
                            headerTextColor, alternateRows, alternateColor } = this.p.table;
                    let css = 'table {\n';
                    
                    css += '  width: 100%;\n';
                    css += '  border-collapse: collapse;\n';
                    css += '  margin: 25px 0;\n';
                    css += `  border: ${borderSize}px solid ${borderColor};\n`;
                    css += '}\n\n';
                    
                    css += 'th, td {\n';
                    css += '  padding: 12px 15px;\n';
                    css += `  border: ${borderSize}px solid ${borderColor};\n`;
                    css += '}\n\n';
                    
                    css += 'thead th {\n';
                    css += `  background-color: ${headerBackground};\n`;
                    css += `  color: ${headerTextColor};\n`;
                    css += '  font-weight: bold;\n';
                    css += '  text-align: left;\n';
                    css += '}\n\n';
                    
                    if (alternateRows) {
                        css += 'tbody tr:nth-child(even) {\n';
                        css += `  background-color: ${alternateColor};\n`;
                        css += '}\n\n';
                    }
                    
                    css += 'tbody tr:hover {\n';
                    css += '  background-color: rgba(0, 0, 0, 0.05);\n';
                    css += '}\n\n';
                    
                    return css;
                },

                listCSS() {
                    const { bulletColor, bulletStyle, bulletSymbol, indentation, spacing } = this.p.list;
                    let css = 'ul, ol {\n';
                    
                    css += `  padding-left: ${indentation}px;\n`;
                    css += `  margin-bottom: ${this.p.advanced.paragraphSpacing}px;\n`;
                    css += '}\n\n';
                    
                    css += 'li {\n';
                    css += `  margin-bottom: ${spacing}px;\n`;
                    css += '}\n\n';
                    
                    if (bulletStyle !== 'default') {
                        css += 'ul {\n';
                        css += '  list-style: none;\n';
                        css += '}\n\n';
                        
                        if (bulletStyle === 'custom') {
                            css += 'ul li::before {\n';
                            css += `  content: "${bulletSymbol}";\n`;
                            css += '  display: inline-block;\n';
                            css += '  width: 1em;\n';
                            css += '  margin-left: -1em;\n';
                            
                            if (bulletColor) {
                                css += `  color: ${bulletColor};\n`;
                            }
                            
                            css += '}\n\n';
                        }
                    } else if (bulletColor) {
                        css += '::marker {\n';
                        css += `  color: ${bulletColor};\n`;
                        css += '}\n\n';
                    }
                    
                    return css;
                },


                sectionCSS() {
                    const { color, size, style, symbol, margin } = this.p.section;
                    let css = 'hr {\n';
                    css += `  margin: ${margin}px 0;\n`;
                    
                    switch (style) {
                        case 'solid':
                        case 'dashed':
                        case 'dotted':
                        case 'double':
                            css += `  border: none;\n  border-top: ${size}px ${style} ${color};\n`;
                            break;
                        case 'wavy':
                            css += '  border: none;\n';
                            css += `  height: ${size*3}px;\n`;
                            css += `  background: url("data:image/svg+xml,%3Csvg width='100' height='${size*3}' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M0,${size*1.5} C25,${size*3} 25,0 50,${size*1.5} C75,${size*3} 75,0 100,${size*1.5}' fill='none' stroke='${encodeURIComponent(color)}' stroke-width='${size}'/%3E%3C/svg%3E") repeat-x;\n`;
                            break;
                        case 'symbols':
                            css += '  border: none;\n';
                            css += '  text-align: center;\n';
                            css += '  height: auto;\n';
                            css += `  line-height: ${size*3}px;\n`;
                            css += `}\n\nhr:after {\n`;
                            css += '  content: "";\n';
                            css += `  display: inline-block;\n`;
                            css += `  width: 100%;\n`;
                            css += `  background-position: center;\n`;
                            css += `  background-repeat: no-repeat;\n`;
                            css += `  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100%' height='${size*3}' viewBox='0 0 160 10'%3E%3Ctext x='0' y='10' fill='${encodeURIComponent(color)}' font-size='10'%3E${symbol} ${symbol} ${symbol} ${symbol} ${symbol} ${symbol} ${symbol} ${symbol} ${symbol} ${symbol} ${symbol} ${symbol} ${symbol} ${symbol} ${symbol} ${symbol} ${symbol} ${symbol} ${symbol} ${symbol}%3C/text%3E%3C/svg%3E");\n`;
                            css += `  height: ${size*3}px;\n`;
                            break;
                        case 'gradient':
                            css += '  height: 1px;\n';
                            css += '  border: none;\n';
                            css += `  background: linear-gradient(to right, transparent, ${color} 20%, ${color} 80%, transparent);\n`;
                            break;
                        case 'faded':
                            css += '  height: 1px;\n';
                            css += '  border: none;\n';
                            css += `  background: linear-gradient(to right, transparent, ${color}, transparent);\n`;
                            break;
                        case 'ornate':
                            css += '  border: none;\n';
                            css += '  text-align: center;\n';
                            css += '  height: auto;\n';
                            css += `}\n\nhr:before, hr:after {\n`;
                            css += '  content: "§";\n';
                            css += `  display: inline-block;\n`;
                            css += `  position: relative;\n`;
                            css += `  top: -0.5em;\n`;
                            css += `  font-size: ${size * 6}px;\n`;
                            css += `  padding: 0 0.5em;\n`;
                            css += `  color: ${color};\n`;
                            css += `}\n\nhr:before {\n`;
                            css += `  transform: rotate(180deg);\n`;
                            break;
                    }
                    
                    css += '}\n\n';
                    return css;
                },
                imageLinkCSS() {
                    const { borderSize, borderColor, borderRadius, 
                        captionSize, captionColor, style, hoverEffect, 
                        layout, itemsPerRow, displayStyle, imagePosition, spacing } = this.p.imageLinks;
                    
                    let css = '.image-link-block {\n';
                    
                    if (layout === 'grid') {
                        css += '  display: flex;\n';
                        css += '  flex-wrap: wrap;\n';
                        css += `  gap: ${spacing}px;\n`;
                        
                        if (displayStyle === 'masonry') {
                            css += '  display: grid;\n';
                            css += `  grid-template-columns: repeat(${itemsPerRow}, 1fr);\n`;
                            css += `  grid-gap: ${spacing}px;\n`;
                            css += '  grid-auto-rows: min-content;\n';
                        } else {
                            css += '  justify-content: space-between;\n';
                        }
                        
                        css += '  margin-bottom: 30px;\n';
                    } else if (layout === 'carousel') {
                        css += '  display: flex;\n';
                        css += '  overflow-x: auto;\n';
                        css += '  scroll-snap-type: x mandatory;\n';
                        css += '  -webkit-overflow-scrolling: touch;\n';
                        css += `  gap: ${spacing}px;\n`;
                        css += '  padding-bottom: 15px;\n'; // For scrollbar space
                        css += '  margin-bottom: 30px;\n';
                    } else if (layout === 'list') {
                        css += '  display: flex;\n';
                        css += '  flex-direction: column;\n';
                        css += `  gap: ${spacing}px;\n`;
                        css += '  margin-bottom: 30px;\n';
                    } else {
                        css += '  margin-bottom: 30px;\n';
                    }
                    
                    css += '}\n\n';
                    
                    css += '.image-link {\n';
                    css += '  display: block;\n';
                    css += '  text-decoration: none;\n';
                    css += '  color: inherit;\n';
                    css += '  transition: all 0.3s ease;\n';
                    
                    if (layout === 'grid') {
                        if (displayStyle === 'masonry') {
                            // In masonry, items take their natural width within the grid
                            css += '  grid-column: span 1;\n';
                        } else {
                            // Standard grid with equal widths
                            const width = `calc(${100 / itemsPerRow}% - ${spacing * (itemsPerRow - 1) / itemsPerRow}px)`;
                            css += `  width: ${width};\n`;
                        }
                    } else if (layout === 'carousel') {
                        css += `  min-width: ${100 / Math.min(itemsPerRow, 3)}%;\n`; // Show at most 3 at once
                        css += '  scroll-snap-align: start;\n';
                        css += '  flex-shrink: 0;\n';
                    } else if (layout === 'list') {
                        css += '  width: 100%;\n';
                    } else {
                        css += '  width: 100%;\n';
                        css += '  margin-bottom: 20px;\n';
                    }
                    
                    css += '}\n\n';
                    
                    // Special handling for list layout
                    if (layout === 'list') {
                        css += '.image-link-inner {\n';
                        css += '  display: flex;\n';
                        css += `  flex-direction: ${imagePosition === 'left' ? 'row' : 'row-reverse'};\n`;
                        css += '  align-items: center;\n';
                        css += '  position: relative;\n';
                        
                        if (borderSize > 0) {
                            css += `  border: ${borderSize}px solid ${borderColor};\n`;
                        }
                        
                        if (borderRadius > 0) {
                            css += `  border-radius: ${borderRadius}px;\n`;
                        }
                        
                        // Apply styles
                        switch (style) {
                            case 'shadow':
                                css += '  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n';
                                break;
                            case 'bordered':
                                css += `  border: ${borderSize > 0 ? borderSize : 2}px solid ${borderColor};\n`;
                                css += '  padding: 6px;\n';
                                break;
                            case 'raised':
                                css += '  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);\n';
                                break;
                        }
                        
                        css += '  overflow: hidden;\n';
                        css += '}\n\n';
                        
                        css += '.image-link img {\n';
                        css += '  display: block;\n';
                        css += '  width: 30%;\n'; // Image takes 30% in list view
                        css += '  object-fit: cover;\n';
                        css += '  height: 100%;\n';
                        css += '  transition: transform 0.3s ease;\n';
                        css += '}\n\n';
                        
                        css += '.image-link-caption {\n';
                        css += '  flex: 1;\n';
                        css += `  padding: 16px;\n`;
                        css += `  font-size: ${captionSize}px;\n`;
                        css += `  color: ${captionColor};\n`;
                        css += '  text-align: left;\n';
                        css += '  font-weight: 500;\n';
                        css += '}\n\n';
                    } else {
                        // Standard image link style for grid and carousel
                        css += '.image-link-inner {\n';
                        css += '  display: block;\n';
                        css += '  position: relative;\n';
                        
                        if (borderSize > 0) {
                            css += `  border: ${borderSize}px solid ${borderColor};\n`;
                        }
                        
                        if (borderRadius > 0) {
                            css += `  border-radius: ${borderRadius}px;\n`;
                        }
                        
                        // Apply styles
                        switch (style) {
                            case 'shadow':
                                css += '  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n';
                                break;
                            case 'bordered':
                                css += `  border: ${borderSize > 0 ? borderSize : 2}px solid ${borderColor};\n`;
                                css += '  padding: 6px;\n';
                                break;
                            case 'raised':
                                css += '  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);\n';
                                break;
                        }
                        
                        css += '  overflow: hidden;\n';
                        css += '}\n\n';
                        
                        css += '.image-link img {\n';
                        css += '  display: block;\n';
                        css += '  width: 100%;\n';
                        css += '  height: auto;\n';
                        css += '  transition: transform 0.3s ease;\n';
                        css += '}\n\n';
                        
                        css += '.image-link-caption {\n';
                        css += `  padding: 12px;\n`;
                        css += `  font-size: ${captionSize}px;\n`;
                        css += `  color: ${captionColor};\n`;
                        css += '  text-align: center;\n';
                        css += '  font-weight: 500;\n';
                        css += '}\n\n';
                    }
                    
                    // Hover effects
                    if (hoverEffect !== 'none') {
                        css += '.image-link:hover .image-link-inner {\n';
                        
                        switch (hoverEffect) {
                            case 'zoom':
                                css += '}\n\n';
                                css += '.image-link:hover img {\n';
                                css += '  transform: scale(1.05);\n';
                                break;
                            case 'brighten':
                                css += '}\n\n';
                                css += '.image-link:hover img {\n';
                                css += '  filter: brightness(1.1);\n';
                                break;
                            case 'lift':
                                css += '  transform: translateY(-5px);\n';
                                css += '  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);\n';
                                break;
                            case 'glow':
                                css += '  box-shadow: 0 0 15px rgba(0, 123, 255, 0.5);\n';
                                break;
                        }
                        
                        css += '}\n\n';
                    }
                    
                    return css;
                },
                advancedCSS() {
                    const { contentWidth, customCSS } = this.p.advanced;
                    let css = '';
                    
                    if (contentWidth < 100) {
                        css += `.content > * {\n  max-width: ${contentWidth}%;\n  margin-left: auto;\n  margin-right: auto;\n}\n\n`;
                    }
                    
                    // Add custom CSS if provided
                    if (customCSS) {
                        css += `/* Custom CSS */\n${customCSS}\n\n`;
                    }
                    
                    return css;
                },
                
                updatePreview() {
                    this.isLoading = true;
                    
                    // Ensure lorem text is generated if needed
                    if (this.p.content.source === 'lorem' && !this.loremTextCache) {
                        this.generateLoremTextCache();
                    }
                    
                    this.loadGoogleFonts().then(() => {
                        const frame = this.$refs.previewFrame;
                        const doc = frame.contentDocument || frame.contentWindow.document;
                        
                        doc.open();
                        doc.write(`
                            <!DOCTYPE html>
                            <html>
                            <head>
                                <meta charset="UTF-8">
                                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                                ${this.loadedFonts.map(font => `<link href="${font}" rel="stylesheet">`).join('\n')}
                                <style>${this.css}</style>
                            </head>
                            <body>
                                ${this.getSampleHTML()}
                            </body>
                            </html>
                        `);
                        doc.close();
                        this.isLoading = false;
                    });
                },
                
                loadGoogleFonts() {
                    return new Promise((resolve) => {
                        // In a real implementation we'd need to load fonts
                        // For demo purposes, we'll just simulate a delay
                        setTimeout(resolve, 100);
                    });
                },
                
                getSampleHTML() {
                    if (this.p.content.source === 'lorem') {
                        return this.getLoremHTML();
                    } else if (this.wikiContent) {
                        return this.getWikiHTML();
                    } else {
                        return this.getDefaultWikiHTML();
                    }
                },
                
                getLoremHTML() {
                    const { loremParagraphs, loremImages, loremHeadings } = this.p.content;
                    
                    // If we haven't generated lorem text yet, do it now
                    if (!this.loremTextCache) {
                        this.generateLoremTextCache();
                    }
                    
                    const heroPanel = this.p.hero.enabled ? 
                        `<div class="hero-panel">
                            <h1 class="post-title">Black Quartz</h1>
                        </div>` : '';
                    
                    let content = '';
                    content += !this.p.hero.enabled ? '<h1 class="post-title">Black Quartz</h1>' : '';
                    
                    // Generate lorem paragraphs interspersed with headings and images
                    const paragraphsPerSection = Math.ceil(loremParagraphs / loremHeadings);
                    const imagesPerSection = Math.ceil(loremImages / loremHeadings);
                    
                    // Add first paragraph (special)
                    content += `<p>${this.loremTextCache[0]}</p>\n`;
                    
                    for (let i = 0; i < loremHeadings; i++) {
                        if (i > 0) {
                            content += '<hr>\n';
                        }
                        
                        content += `<h2>Section Heading ${i + 1}</h2>\n`;
                        
                        // Add paragraphs and images for this section
                        for (let p = 0; p < paragraphsPerSection; p++) {
                            if (p % 2 === 0 && p < imagesPerSection) {
                                // Add an image
                                const width = 600 + (i * 100) % 300;
                                const height = 300 + (p * 50) % 200;
                                const seed = i * 10 + p;
                                content += this.getImageHTML(width, height, seed);
                            }
                            
                            // Use cached lorem text
                            const paraIndex = i * paragraphsPerSection + p + 1; // +1 because we used index 0 already
                            if (paraIndex < this.loremTextCache.length) {
                                content += `<p>${this.loremTextCache[paraIndex]}</p>\n`;
                            }
                            
                            // Add a subheading halfway through
                            if (p === Math.floor(paragraphsPerSection / 2) && paragraphsPerSection > 2) {
                                content += `<h3>Subsection ${i + 1}.${p + 1}</h3>\n`;
                            }
                        }
                    }
                    
                    content += `<p>Some text with a <a href="#">link</a> to demonstrate link styling. And <a href="#">another link</a> for good measure.</p>`;
                    
                    // Add after a paragraph
                    content += `<h2>More Style Examples</h2>\n`;
                    content += `
                        <blockquote>
                            ${this.loremTextCache[Math.floor(Math.random() * this.loremTextCache.length)]}
                        </blockquote>
                    `;

                    // Add a table example
                    content += `
                        <table>
                            <thead>
                                <tr>
                                    <th>Header 1</th>
                                    <th>Header 2</th>
                                    <th>Header 3</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Data 1A</td>
                                    <td>Data 1B</td>
                                    <td>Data 1C</td>
                                </tr>
                                <tr>
                                    <td>Data 2A</td>
                                    <td>Data 2B</td>
                                    <td>Data 2C</td>
                                </tr>
                                <tr>
                                    <td>Data 3A</td>
                                    <td>Data 3B</td>
                                    <td>Data 3C</td>
                                </tr>
                            </tbody>
                        </table>
                    `;

                    // Add list examples
                    content += `
                        <h3>Unordered List</h3>
                        <ul>
                            <li>First item in the list</li>
                            <li>Second item in the list</li>
                            <li>Third item with a <a href="#">link</a> inside</li>
                            <li>Fourth and final item</li>
                        </ul>
                        
                        <h3>Ordered List</h3>
                        <ol>
                            <li>First numbered item</li>
                            <li>Second numbered item</li>
                            <li>Third numbered item</li>
                        </ol>
                    `;
                    content += '<h2>Related Articles</h2>\n';
                    content += this.getImageLinksHTML();
                    return `
                        <div class="page-container">
                            ${heroPanel}
                            <div class="content">
                                ${content}
                            </div>
                        </div>
                    `;
                },
                
                getWikiHTML() {
                    if (!this.wikiContent) return this.getDefaultWikiHTML();
                    
                    const { title, extract, thumbnail, sections } = this.wikiContent;
                    
                    const heroPanel = this.p.hero.enabled ? 
                        `<div class="hero-panel">
                            <h1 class="post-title">${title}</h1>
                        </div>` : '';
                    
                    let content = '';
                    content += !this.p.hero.enabled ? `<h1 class="post-title">${title}</h1>` : '';
                    
                    // Add intro paragraph
                    content += `<p>${extract}</p>\n`;
                    
                    // Add first image if available
                    if (thumbnail) {
                        content += this.getImageHTML(thumbnail, 800, 400, 1, `${title} thumbnail`);
                    } else {
                        // Placeholder
                        content += this.getImageHTML(800, 400, 1, `${title} illustration`);
                    }
                    
                    // Add sections
                    if (sections && sections.length) {
                        sections.forEach((section, i) => {
                            if (i > 0) {
                                content += '<hr>\n';
                            }
                            
                            // Add section heading if it's not empty or "See also", "References", etc.
                            if (section.line && !['See also', 'References', 'External links', 'Notes', 'Bibliography'].includes(section.line)) {
                                content += `<h2>${section.line}</h2>\n`;
                                
                                // Add section text if available
                                if (section.text) {
                                    content += `<p>${section.text}</p>\n`;
                                } else {
                                    // Placeholder text
                                    content += `<p>${this.getLoremText()}</p>\n`;
                                }
                                
                                // Add image for some sections
                                if (i % 2 === 0) {
                                    content += this.getImageHTML(700, 350, i+2, `Illustration related to ${section.line}`);
                                }
                            }
                        });
                    }
                    
                    content += `<p>Some text with a <a href="#">link</a> to demonstrate link styling. And <a href="#">another link</a> for good measure.</p>`;
                    
                    return `
                        <div class="page-container">
                            ${heroPanel}
                            <div class="content">
                                ${content}
                            </div>
                        </div>
                    `;
                },
                
                getDefaultWikiHTML() {
                    // Default content shown before a wiki article is loaded
                    const heroPanel = this.p.hero.enabled ? 
                        `<div class="hero-panel">
                            <h1 class="post-title">Wikipedia Article</h1>
                        </div>` : '';
                    
                    return `
                        <div class="page-container">
                            ${heroPanel}
                            <div class="content">
                                ${!this.p.hero.enabled ? '<h1 class="post-title">Wikipedia Article</h1>' : ''}
                                <p>Search for a Wikipedia article in the content settings to load real article content.</p>
                                <p>Or switch to Lorem Ipsum mode to see generated demo content.</p>
                            </div>
                        </div>
                    `;
                },
                
                getImageHTML(widthOrUrl, height, seed, caption) {
                    // Handle different types of parameters
                    let imgUrl;
                    if (typeof widthOrUrl === 'string' && widthOrUrl.startsWith('http')) {
                        // It's already a URL
                        imgUrl = widthOrUrl;
                    } else {
                        // It's a width, so construct a URL
                        const width = widthOrUrl;
                        imgUrl = `https://picsum.photos/${width}/${height}?random=${seed}`;
                    }
                    
                    caption = caption || `Image caption ${seed}`;
                    
                    return `
                        <div class="image-container">
                            <img src="${imgUrl}" alt="Sample image ${seed}">
                            <div class="image-caption">${caption}</div>
                        </div>
                    `;
                },
                
                getLoremText() {
                    const loremTexts = [
                        "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam vehicula ipsum a arcu cursus vitae congue mauris rhoncus. Aenean et justo at enim pulvinar malesuada.",
                        "Vestibulum sed arcu non odio euismod lacinia at quis risus. Semper quis lectus nulla at volutpat diam ut venenatis tellus. Bibendum est ultricies integer quis auctor.",
                        "Faucibus interdum posuere lorem ipsum dolor sit amet consectetur adipiscing. Platea dictumst vestibulum rhoncus est pellentesque elit ullamcorper dignissim cras.",
                        "Amet porttitor eget dolor morbi non arcu risus quis varius. Ut enim blandit volutpat maecenas volutpat blandit aliquam etiam erat velit.",
                        "Cras fermentum odio eu feugiat pretium nibh ipsum consequat. Magna etiam tempor orci eu lobortis elementum nibh tellus molestie nunc.",
                        "Ultricies tristique nulla aliquet enim tortor at auctor urna nunc. Semper auctor neque vitae tempus quam pellentesque nec nam aliquam.",
                        "Proin sagittis nisl rhoncus mattis rhoncus urna neque viverra justo. Imperdiet proin fermentum leo vel orci porta non pulvinar neque."
                    ];
                    
                    // Return a random lorem text
                    return loremTexts[Math.floor(Math.random() * loremTexts.length)];
                },
                
                generateRandomHeroImage() {
                    const seed = Math.floor(Math.random() * 1000);
                    const width = this.p.hero.placeholderWidth;
                    const height = Math.round(width / 2);
                    this.p.hero.imageUrl = `https://picsum.photos/${width}/${height}?random=${seed}`;
                    this.updatePreview();
                },
                getImageLinksHTML() {
                    const { layout, imagePosition } = this.p.imageLinks;
                    
                    // Sample blog post links
                    const links = [
                        { url: '#post1', image: 'https://picsum.photos/400/250?random=101', title: 'Getting Started with CSS' },
                        { url: '#post2', image: 'https://picsum.photos/400/250?random=102', title: 'Advanced Typography Techniques' },
                        { url: '#post3', image: 'https://picsum.photos/400/250?random=103', title: 'Responsive Design Principles' },
                        { url: '#post4', image: 'https://picsum.photos/400/250?random=104', title: 'Color Theory for Web Designers' },
                        { url: '#post5', image: 'https://picsum.photos/400/250?random=105', title: 'Web Performance Optimization' }
                    ];
                    
                    let html = '<div class="image-link-block">\n';
                    
                    for (const link of links) {
                        html += `  <a href="${link.url}" class="image-link">\n`;
                        html += `    <div class="image-link-inner">\n`;
                        
                        if (layout === 'list') {
                            // For list layout, keep the image and caption in the right order
                            html += `      <img src="${link.image}" alt="${link.title}">\n`;
                            html += `      <div class="image-link-caption">${link.title}</div>\n`;
                        } else {
                            // Standard layout
                            html += `      <img src="${link.image}" alt="${link.title}">\n`;
                            html += `      <div class="image-link-caption">${link.title}</div>\n`;
                        }
                        
                        html += `    </div>\n`;
                        html += `  </a>\n`;
                    }
                    
                    html += '</div>\n';
                    
                    return html;
                },
                exportCSS() {
                    const themeJSON = JSON.stringify(this.p, null, 2);
                    const jsonComment = `/*
                BlackQuartz Theme Settings
                --------------------------
                Copy the JSON below to save your theme or reimport it later:


                START_BLACKQUARTZ_THEME
                ${themeJSON}
                END_BLACKQUARTZ_THEME
                --------------------------
                */

                `;
                    
                    // Add the comment to the top of the CSS
                    const css = jsonComment + this.css;

                    const blob = new Blob([css], { type: 'text/css' });
                    const url = URL.createObjectURL(blob);
                    
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'blackquartz-theme.css';
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                },
                
                copyCSS() {
                    const tempTextarea = document.createElement('textarea');
                    tempTextarea.value = this.css;
                    document.body.appendChild(tempTextarea);
                    tempTextarea.select();
                    document.execCommand('copy');
                    document.body.removeChild(tempTextarea);
                    
                    alert('CSS copied to clipboard!');
                },
                
                exportHTML() {
                    const html = `
                        <!DOCTYPE html>
                        <html>
                        <head>
                            <meta charset="UTF-8">
                            <meta name="viewport" content="width=device-width, initial-scale=1.0">
                            <title>BlackQuartz Theme Demo</title>
                            ${this.loadedFonts.map(font => `<link href="${font}" rel="stylesheet">`).join('\n')}
                            <style>${this.css}</style>
                        </head>
                        <body>
                            ${this.getSampleHTML()}
                        </body>
                        </html>
                    `;
                    
                    const blob = new Blob([html], { type: 'text/html' });
                    const url = URL.createObjectURL(blob);
                    
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'blackquartz-demo.html';
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                },
                
                applyColorPalette(palette) {
                    this.p.bg.c1 = palette.c1;
                    this.p.bg.c2 = palette.c2;
                    this.updatePreview();
                },
                
                applyPreset(preset) {
                    const presets = {
                        modern: {
                            bg: {c1: '#ffffff', c2: '#f8f9fa', style: 'solid'},
                            page: {enabled: true, bgColor: '#ffffff', shadowSize: 15, borderSize: 0, paddingX: 60, paddingY: 60, maxWidth: 900},
                            type: {
                                bodyFont: "'Inter', sans-serif",
                                headingFont: "'Inter', sans-serif",
                                lineHeight: 1.7,
                                titleColor: '#111827',
                                titleSize: 42,
                                titleStyle: 'normal',
                                titleAlign: 'left',
                                headingColor: '#1f2937',
                                headingSize: 28,
                                headingStyle: 'normal',
                                textColor: '#4b5563',
                                textSize: 17,
                                linkColor: '#2563eb',
                                linkHoverColor: '#1d4ed8',
                                linkUnderline: false,
                                linkHoverEffect: 'underline'
                            },
                            hero: {
                                enabled: true,
                                type: 'color',
                                c1: '#f8fafc',
                                c2: '#f1f5f9',
                                style: 'gradient',
                                paddingX: 60,
                                paddingY: 80
                            },
                            img: {
                                borderSize: 0,
                                padding: 0,
                                borderRadius: 8,
                                style: 'shadow',
                                hoverEffect: 'lift'
                            },
                            section: {
                                color: '#e5e7eb',
                                size: 1,
                                style: 'solid',
                                margin: 60
                            }
                        },
                        dark: {
                            bg: {c1: '#111827', c2: '#1f2937', style: 'gradient'},
                            page: {enabled: true, bgColor: '#1f2937', shadowSize: 20, borderSize: 1, borderColor: '#374151', paddingX: 50, paddingY: 50, maxWidth: 850},
                            type: {
                                bodyFont: "'Inter', sans-serif",
                                headingFont: "'Inter', sans-serif",
                                lineHeight: 1.8,
                                titleColor: '#f9fafb',
                                titleSize: 40,
                                titleStyle: 'normal',
                                titleAlign: 'left',
                                headingColor: '#f3f4f6',
                                headingSize: 26,
                                headingStyle: 'leftBorder',
                                textColor: '#d1d5db',
                                textSize: 16,
                                linkColor: '#60a5fa',
                                linkHoverColor: '#93c5fd',
                                linkUnderline: false,
                                linkHoverEffect: 'underline'
                            },
                            hero: {
                                enabled: true,
                                type: 'color',
                                c1: '#0f172a',
                                c2: '#1e293b',
                                style: 'gradient',
                                paddingX: 50,
                                paddingY: 70
                            },
                            img: {
                                borderSize: 0,
                                padding: 0,
                                borderRadius: 8,
                                style: 'shadow',
                                hoverEffect: 'brighten'
                            },
                            section: {
                                color: '#4b5563',
                                size: 1,
                                style: 'gradient',
                                margin: 60
                            }
                        },
                        newspaper: {
                            bg: {c1: '#f5f5f5', c2: '#e5e5e5', style: 'solid'},
                            page: {enabled: true, bgColor: '#ffffff', shadowSize: 5, borderSize: 0, paddingX: 40, paddingY: 40, maxWidth: 740},
                            type: {
                                bodyFont: "'Georgia', serif",
                                headingFont: "'Georgia', serif",
                                lineHeight: 1.6,
                                titleColor: '#000000',
                                titleSize: 38,
                                titleStyle: 'normal',
                                titleAlign: 'center',
                                headingColor: '#000000',
                                headingSize: 24,
                                headingStyle: 'underline',
                                textColor: '#222222',
                                textSize: 18,
                                linkColor: '#1a1a1a',
                                linkHoverColor: '#444444',
                                linkUnderline: true,
                                linkHoverEffect: 'none'
                            },
                            hero: {
                                enabled: false
                            },
                            img: {
                                borderSize: 1,
                                borderColor: '#000000',
                                padding: 0,
                                borderRadius: 0,
                                style: 'normal',
                                hoverEffect: 'none'
                            },
                            section: {
                                color: '#000000',
                                size: 1,
                                style: 'solid',
                                margin: 40
                            },
                            advanced: {
                                contentWidth: 90,
                                paragraphIndent: 20,
                                paragraphSpacing: 20
                            }
                        },
                        magazine: {
                            bg: {c1: '#ffffff', c2: '#ffffff', style: 'solid'},
                            page: {enabled: true, bgColor: '#ffffff', shadowSize: 0, borderSize: 0, paddingX: 60, paddingY: 60, maxWidth: 1000},
                            type: {
                                bodyFont: "'Libre Baskerville', serif",
                                headingFont: "'Playfair Display', serif",
                                lineHeight: 1.7,
                                titleColor: '#111111',
                                titleSize: 48,
                                titleStyle: 'highlight',
                                titleAlign: 'left',
                                headingColor: '#111111',
                                headingSize: 30,
                                headingStyle: 'normal',
                                textColor: '#333333',
                                textSize: 18,
                                linkColor: '#c0392b',
                                linkHoverColor: '#e74c3c',
                                linkUnderline: false,
                                linkHoverEffect: 'underline'
                            },
                            hero: {
                                enabled: true,
                                type: 'image',
                                overlayOpacity: 0.2,
                                paddingX: 80,
                                paddingY: 100,
                                titleEffect: 'shadow'
                            },
                            img: {
                                borderSize: 0,
                                padding: 0,
                                borderRadius: 0,
                                style: 'normal',
                                displayWidth: 'full',
                                hoverEffect: 'none'
                            },
                            section: {
                                color: '#111111',
                                size: 2,
                                style: 'symbols',
                                symbol: '★',
                                margin: 70
                            }
                        },
                        colorful: {
                            bg: {c1: '#4158D0', c2: '#C850C0', style: 'gradient'},
                            page: {enabled: true, bgColor: '#ffffff', shadowSize: 30, borderSize: 0, borderRadius: 20, paddingX: 50, paddingY: 50, maxWidth: 880},
                            type: {
                                bodyFont: "'Poppins', sans-serif",
                                headingFont: "'Poppins', sans-serif",
                                lineHeight: 1.7,
                                titleColor: '#8A2BE2',
                                titleSize: 44,
                                titleStyle: 'gradient',
                                titleAlign: 'center',
                                headingColor: '#C850C0',
                                headingSize: 28,
                                headingStyle: 'gradient',
                                textColor: '#333333',
                                textSize: 16,
                                linkColor: '#4158D0',
                                linkHoverColor: '#8A2BE2',
                                linkUnderline: false,
                                linkHoverEffect: 'highlight'
                            },
                            hero: {
                                enabled: true,
                                type: 'color',
                                c1: '#4158D0',
                                c2: '#C850C0',
                                style: 'gradient',
                                paddingX: 40,
                                paddingY: 70,
                                borderRadius: 20
                            },
                            img: {
                                borderSize: 0,
                                padding: 0,
                                borderRadius: 15,
                                style: 'shadow',
                                hoverEffect: 'zoom'
                            },
                            section: {
                                color: '#C850C0',
                                size: 2,
                                style: 'gradient',
                                margin: 50
                            }
                        },
                        elegant: {
                            bg: {c1: '#f8f5f0', c2: '#efe8e0', style: 'gradient'},
                            page: {enabled: true, bgColor: '#ffffff', shadowSize: 0, borderSize: 0, paddingX: 70, paddingY: 70, maxWidth: 800},
                            type: {
                                bodyFont: "'Cormorant Garamond', serif",
                                headingFont: "'Cormorant Garamond', serif",
                                lineHeight: 1.8,
                                titleColor: '#3a2d1f',
                                titleSize: 50,
                                titleStyle: 'normal',
                                titleAlign: 'center',
                                titleSpaceBelow: 40,
                                headingColor: '#3a2d1f',
                                headingSize: 32,
                                headingStyle: 'normal',
                                textColor: '#5a4a3f',
                                textSize: 20,
                                linkColor: '#a98467',
                                linkHoverColor: '#836953',
                                linkUnderline: false,
                                linkHoverEffect: 'underline'
                            },
                            hero: {
                                enabled: false
                            },
                            img: {
                                borderSize: 0,
                                padding: 10,
                                borderRadius: 0,
                                style: 'frame',
                                hoverEffect: 'none'
                            },
                            section: {
                                color: '#a98467',
                                size: 1,
                                style: 'ornate',
                                margin: 60
                            },
                            advanced: {
                                contentWidth: 85,
                                paragraphIndent: 0,
                                paragraphSpacing: 30
                            }
                        },
                        minimal: {
                            bg: {c1: '#ffffff', c2: '#ffffff', style: 'solid'},
                            page: {enabled: true, bgColor: '#ffffff', shadowSize: 0, borderSize: 0, paddingX: 20, paddingY: 40, maxWidth: 680},
                            type: {
                                bodyFont: "'IBM Plex Sans', sans-serif",
                                headingFont: "'IBM Plex Sans', sans-serif",
                                lineHeight: 1.6,
                                titleColor: '#000000',
                                titleSize: 32,
                                titleStyle: 'normal',
                                titleAlign: 'left',
                                headingColor: '#000000',
                                headingSize: 22,
                                headingStyle: 'normal',
                                textColor: '#333333',
                                textSize: 16,
                                linkColor: '#000000',
                                linkHoverColor: '#666666',
                                linkUnderline: true,
                                linkHoverEffect: 'none'
                            },
                            hero: {
                                enabled: false
                            },
                            img: {
                                borderSize: 0,
                                padding: 0,
                                borderRadius: 0,
                                style: 'normal',
                                hoverEffect: 'none'
                            },
                            section: {
                                color: '#eaeaea',
                                size: 1,
                                style: 'solid',
                                margin: 40
                            }
                        },
                        retro: {
                            bg: {c1: '#fffbe6', c2: '#fffbe6', style: 'solid'},
                            page: {enabled: true, bgColor: '#fffbe6', shadowSize: 0, borderSize: 2, borderColor: '#bc9f77', paddingX: 50, paddingY: 50, maxWidth: 800},
                            type: {
                                bodyFont: "'Courier Prime', monospace",
                                headingFont: "'Abril Fatface', display",
                                lineHeight: 1.6,
                                titleColor: '#994636',
                                titleSize: 40,
                                titleStyle: 'normal',
                                titleAlign: 'center',
                                headingColor: '#994636',
                                headingSize: 26,
                                headingStyle: 'normal',
                                textColor: '#594a42',
                                textSize: 16,
                                linkColor: '#994636',
                                linkHoverColor: '#b25747',
                                linkUnderline: true,
                                linkHoverEffect: 'none'
                            },
                            hero: {
                                enabled: true,
                                type: 'color',
                                c1: '#ecdfc8',
                                c2: '#ecdfc8',
                                style: 'solid',
                                paddingX: 30,
                                paddingY: 40
                            },
                            img: {
                                borderSize: 3,
                                borderColor: '#bc9f77',
                                padding: 10,
                                borderRadius: 0,
                                style: 'polaroid',
                                hoverEffect: 'none'
                            },
                            section: {
                                color: '#bc9f77',
                                size: 2,
                                style: 'dashed',
                                margin: 30
                            }
                        },

                        // Professional Themes
                        corporate: {
                            bg: {c1: '#f5f7fa', c2: '#e4e7eb', style: 'solid'},
                            page: {enabled: true, bgColor: '#ffffff', shadowSize: 10, borderSize: 0, paddingX: 50, paddingY: 50, maxWidth: 1100},
                            type: {
                                bodyFont: "'Roboto', sans-serif",
                                headingFont: "'Montserrat', sans-serif",
                                lineHeight: 1.6,
                                titleColor: '#2c3e50',
                                titleSize: 36,
                                titleStyle: 'normal',
                                titleAlign: 'left',
                                headingColor: '#34495e',
                                headingSize: 24,
                                headingStyle: 'leftBorder',
                                textColor: '#4a5568',
                                textSize: 16,
                                linkColor: '#3498db',
                                linkHoverColor: '#2980b9',
                                linkUnderline: false,
                                linkHoverEffect: 'underline'
                            },
                            hero: {
                                enabled: true,
                                type: 'color',
                                c1: '#f8fafc',
                                c2: '#edf2f7',
                                style: 'solid',
                                paddingX: 50,
                                paddingY: 60
                            },
                            img: {
                                borderSize: 0,
                                padding: 0,
                                borderRadius: 4,
                                style: 'normal',
                                hoverEffect: 'lift'
                            },
                            section: {
                                color: '#e2e8f0',
                                size: 1,
                                style: 'solid',
                                margin: 50
                            }
                        },
                        
                        tech: {
                            bg: {c1: '#0a0a0a', c2: '#141414', style: 'solid'},
                            page: {enabled: true, bgColor: '#0f0f0f', shadowSize: 0, borderSize: 1, borderColor: '#2d2d2d', paddingX: 40, paddingY: 40, maxWidth: 1000},
                            type: {
                                bodyFont: "'JetBrains Mono', monospace",
                                headingFont: "'JetBrains Mono', monospace",
                                lineHeight: 1.7,
                                titleColor: '#00ff41',
                                titleSize: 32,
                                titleStyle: 'normal',
                                titleAlign: 'left',
                                headingColor: '#00ff41',
                                headingSize: 22,
                                headingStyle: 'normal',
                                textColor: '#a0a0a0',
                                textSize: 15,
                                linkColor: '#00ff41',
                                linkHoverColor: '#00cc33',
                                linkUnderline: false,
                                linkHoverEffect: 'highlight'
                            },
                            hero: {
                                enabled: true,
                                type: 'color',
                                c1: '#000000',
                                c2: '#070707',
                                style: 'solid',
                                paddingX: 40,
                                paddingY: 60
                            },
                            img: {
                                borderSize: 1,
                                borderColor: '#00ff41',
                                padding: 0,
                                borderRadius: 0,
                                style: 'normal',
                                hoverEffect: 'brighten'
                            },
                            section: {
                                color: '#00ff41',
                                size: 1,
                                style: 'dotted',
                                margin: 40
                            }
                        },
                        
                        medical: {
                            bg: {c1: '#f0f5fa', c2: '#f0f5fa', style: 'solid'},
                            page: {enabled: true, bgColor: '#ffffff', shadowSize: 8, borderSize: 0, paddingX: 50, paddingY: 50, maxWidth: 900},
                            type: {
                                bodyFont: "'Source Sans Pro', sans-serif",
                                headingFont: "'Source Sans Pro', sans-serif",
                                lineHeight: 1.6,
                                titleColor: '#005593',
                                titleSize: 36,
                                titleStyle: 'normal',
                                titleAlign: 'left',
                                headingColor: '#005593',
                                headingSize: 24,
                                headingStyle: 'normal',
                                textColor: '#444444',
                                textSize: 16,
                                linkColor: '#0077cc',
                                linkHoverColor: '#005593',
                                linkUnderline: false,
                                linkHoverEffect: 'underline'
                            },
                            hero: {
                                enabled: true,
                                type: 'color',
                                c1: '#e1f5fe',
                                c2: '#e1f5fe',
                                style: 'solid',
                                paddingX: 40,
                                paddingY: 50
                            },
                            img: {
                                borderSize: 0,
                                padding: 0,
                                borderRadius: 8,
                                style: 'shadow',
                                hoverEffect: 'none'
                            },
                            section: {
                                color: '#b3e0ff',
                                size: 1,
                                style: 'solid',
                                margin: 40
                            }
                        },
                        
                        legal: {
                            bg: {c1: '#f8f9fa', c2: '#f8f9fa', style: 'solid'},
                            page: {enabled: true, bgColor: '#ffffff', shadowSize: 5, borderSize: 0, paddingX: 60, paddingY: 60, maxWidth: 850},
                            type: {
                                bodyFont: "'Lora', serif",
                                headingFont: "'Crimson Text', serif",
                                lineHeight: 1.8,
                                titleColor: '#2c3e50',
                                titleSize: 38,
                                titleStyle: 'normal',
                                titleAlign: 'center',
                                headingColor: '#34495e',
                                headingSize: 26,
                                headingStyle: 'normal',
                                textColor: '#3c4858',
                                textSize: 17,
                                linkColor: '#6b7280',
                                linkHoverColor: '#4b5563',
                                linkUnderline: true,
                                linkHoverEffect: 'none'
                            },
                            hero: {
                                enabled: false
                            },
                            img: {
                                borderSize: 0,
                                padding: 0,
                                borderRadius: 0,
                                style: 'normal',
                                hoverEffect: 'none'
                            },
                            section: {
                                color: '#d1d5db',
                                size: 1,
                                style: 'double',
                                margin: 50
                            },
                            advanced: {
                                contentWidth: 90,
                                paragraphIndent: 30,
                                paragraphSpacing: 25
                            }
                        },
                        
                        // Creative Themes
                        artistic: {
                            bg: {c1: '#ffffff', c2: '#fafafa', style: 'solid'},
                            page: {enabled: true, bgColor: '#ffffff', shadowSize: 0, borderSize: 0, paddingX: 50, paddingY: 60, maxWidth: 1200},
                            type: {
                                bodyFont: "'Karla', sans-serif",
                                headingFont: "'Playfair Display', serif",
                                lineHeight: 1.8,
                                titleColor: '#222222',
                                titleSize: 52,
                                titleStyle: 'normal',
                                titleAlign: 'left',
                                headingColor: '#333333',
                                headingSize: 32,
                                headingStyle: 'normal',
                                textColor: '#555555',
                                textSize: 18,
                                linkColor: '#000000',
                                linkHoverColor: '#777777',
                                linkUnderline: false,
                                linkHoverEffect: 'underline'
                            },
                            hero: {
                                enabled: true,
                                type: 'image',
                                overlayOpacity: 0.1,
                                paddingX: 60,
                                paddingY: 120,
                                titleEffect: 'none'
                            },
                            img: {
                                borderSize: 0,
                                padding: 0,
                                borderRadius: 0,
                                style: 'normal',
                                displayWidth: 'full',
                                hoverEffect: 'zoom'
                            },
                            section: {
                                color: '#eeeeee',
                                size: 1,
                                style: 'solid',
                                margin: 80
                            }
                        },
                        
                        writer: {
                            bg: {c1: '#faf7f2', c2: '#f5f1e6', style: 'solid'},
                            page: {enabled: true, bgColor: '#ffffff', shadowSize: 3, borderSize: 0, paddingX: 60, paddingY: 60, maxWidth: 720},
                            type: {
                                bodyFont: "'Merriweather', serif",
                                headingFont: "'Merriweather', serif",
                                lineHeight: 1.9,
                                titleColor: '#2d2d2d',
                                titleSize: 36,
                                titleStyle: 'normal',
                                titleAlign: 'center',
                                headingColor: '#2d2d2d',
                                headingSize: 24,
                                headingStyle: 'normal',
                                textColor: '#4a4a4a',
                                textSize: 18,
                                linkColor: '#b07d62',
                                linkHoverColor: '#8c6046',
                                linkUnderline: true,
                                linkHoverEffect: 'none'
                            },
                            hero: {
                                enabled: false
                            },
                            img: {
                                borderSize: 0,
                                padding: 15,
                                borderRadius: 0,
                                style: 'normal',
                                hoverEffect: 'none'
                            },
                            section: {
                                color: '#e1d7ca',
                                size: 1,
                                style: 'wavy',
                                margin: 60
                            },
                            advanced: {
                                contentWidth: 80,
                                paragraphIndent: 40,
                                paragraphSpacing: 30,
                                firstLetterSize: 2.5
                            }
                        },
                        
                        photographer: {
                            bg: {c1: '#000000', c2: '#000000', style: 'solid'},
                            page: {enabled: true, bgColor: '#0d0d0d', shadowSize: 0, borderSize: 0, paddingX: 0, paddingY: 0, maxWidth: 1400},
                            type: {
                                bodyFont: "'Montserrat', sans-serif",
                                headingFont: "'Montserrat', sans-serif",
                                lineHeight: 1.7,
                                titleColor: '#ffffff',
                                titleSize: 40,
                                titleStyle: 'normal',
                                titleAlign: 'left',
                                headingColor: '#ffffff',
                                headingSize: 24,
                                headingStyle: 'normal',
                                textColor: '#cccccc',
                                textSize: 16,
                                linkColor: '#ffffff',
                                linkHoverColor: '#f2f2f2',
                                linkUnderline: false,
                                linkHoverEffect: 'opacity'
                            },
                            hero: {
                                enabled: true,
                                type: 'image',
                                overlayOpacity: 0.6,
                                paddingX: 40,
                                paddingY: 200,
                                titleEffect: 'shadow'
                            },
                            img: {
                                borderSize: 0,
                                padding: 0,
                                borderRadius: 0,
                                style: 'normal',
                                displayWidth: 'full',
                                hoverEffect: 'zoom'
                            },
                            section: {
                                color: '#333333',
                                size: 1,
                                style: 'solid',
                                margin: 80
                            }
                        },
                        
                        // Niche Themes
                        food: {
                            bg: {c1: '#fafafa', c2: '#f5f5f5', style: 'solid'},
                            page: {enabled: true, bgColor: '#ffffff', shadowSize: 10, borderSize: 0, paddingX: 50, paddingY: 50, maxWidth: 800},
                            type: {
                                bodyFont: "'Open Sans', sans-serif",
                                headingFont: "'Amatic SC', cursive",
                                lineHeight: 1.7,
                                titleColor: '#5a3921',
                                titleSize: 60,
                                titleStyle: 'normal',
                                titleAlign: 'center',
                                headingColor: '#5a3921',
                                headingSize: 40,
                                headingStyle: 'normal',
                                textColor: '#5b5b5b',
                                textSize: 17,
                                linkColor: '#ff6b6b',
                                linkHoverColor: '#e95757',
                                linkUnderline: false,
                                linkHoverEffect: 'underline'
                            },
                            hero: {
                                enabled: true,
                                type: 'image',
                                overlayOpacity: 0.3,
                                paddingX: 40,
                                paddingY: 90
                            },
                            img: {
                                borderSize: 0,
                                padding: 0,
                                borderRadius: 8,
                                style: 'shadow',
                                hoverEffect: 'zoom'
                            },
                            section: {
                                color: '#ffb38a',
                                size: 1,
                                style: 'symbols',
                                symbol: '♨',
                                margin: 40
                            }
                        },
                        
                        travel: {
                            bg: {c1: '#e6f7ff', c2: '#f0f7ff', style: 'gradient'},
                            page: {enabled: true, bgColor: '#ffffff', shadowSize: 15, borderSize: 0, paddingX: 40, paddingY: 40, maxWidth: 900},
                            type: {
                                bodyFont: "'Lato', sans-serif",
                                headingFont: "'Quicksand', sans-serif",
                                lineHeight: 1.7,
                                titleColor: '#3498db',
                                titleSize: 42,
                                titleStyle: 'normal',
                                titleAlign: 'left',
                                headingColor: '#2980b9',
                                headingSize: 26,
                                headingStyle: 'normal',
                                textColor: '#555555',
                                textSize: 17,
                                linkColor: '#3498db',
                                linkHoverColor: '#2980b9',
                                linkUnderline: false,
                                linkHoverEffect: 'underline'
                            },
                            hero: {
                                enabled: true,
                                type: 'image',
                                overlayOpacity: 0.4,
                                paddingX: 40,
                                paddingY: 100,
                                titleEffect: 'shadow'
                            },
                            img: {
                                borderSize: 0,
                                padding: 0,
                                borderRadius: 10,
                                style: 'shadow',
                                hoverEffect: 'zoom'
                            },
                            section: {
                                color: '#bde0ff',
                                size: 1,
                                style: 'symbols',
                                symbol: '✈',
                                margin: 50
                            }
                        },
                        
                        fashion: {
                            bg: {c1: '#ffffff', c2: '#ffffff', style: 'solid'},
                            page: {enabled: true, bgColor: '#ffffff', shadowSize: 0, borderSize: 0, paddingX: 40, paddingY: 40, maxWidth: 1000},
                            type: {
                                bodyFont: "'Nunito Sans', sans-serif",
                                headingFont: "'Tenor Sans', sans-serif",
                                lineHeight: 1.6,
                                titleColor: '#000000',
                                titleSize: 36,
                                titleStyle: 'normal',
                                titleAlign: 'center',
                                headingColor: '#000000',
                                headingSize: 22,
                                headingStyle: 'normal',
                                textColor: '#333333',
                                textSize: 16,
                                linkColor: '#000000',
                                linkHoverColor: '#909090',
                                linkUnderline: false,
                                linkHoverEffect: 'opacity'
                            },
                            hero: {
                                enabled: true,
                                type: 'image',
                                overlayOpacity: 0.1,
                                paddingX: 30,
                                paddingY: 80
                            },
                            img: {
                                borderSize: 0,
                                padding: 0,
                                borderRadius: 0,
                                style: 'normal',
                                displayWidth: 'full',
                                hoverEffect: 'none'
                            },
                            section: {
                                color: '#e0e0e0',
                                size: 1,
                                style: 'solid',
                                margin: 60
                            }
                        },
                        
                        gaming: {
                            bg: {c1: '#090a15', c2: '#121320', style: 'gradient'},
                            page: {enabled: true, bgColor: '#0f1119', shadowSize: 20, shadowColor: '#ff00ff30', borderSize: 1, borderColor: '#9146ff', paddingX: 40, paddingY: 40, maxWidth: 1000},
                            type: {
                                bodyFont: "'Exo 2', sans-serif",
                                headingFont: "'Exo 2', sans-serif",
                                lineHeight: 1.6,
                                titleColor: '#ffffff',
                                titleSize: 40,
                                titleStyle: 'gradient',
                                titleAlign: 'left',
                                headingColor: '#e6e6fa',
                                headingSize: 26,
                                headingStyle: 'gradient',
                                textColor: '#b8b8e6',
                                textSize: 16,
                                linkColor: '#9146ff',
                                linkHoverColor: '#a970ff',
                                linkUnderline: false,
                                linkHoverEffect: 'glow'
                            },
                            hero: {
                                enabled: true,
                                type: 'color',
                                c1: '#000428',
                                c2: '#004e92',
                                style: 'gradient',
                                paddingX: 40,
                                paddingY: 60
                            },
                            img: {
                                borderSize: 1,
                                borderColor: '#9146ff',
                                padding: 0,
                                borderRadius: 5,
                                style: 'neon',
                                hoverEffect: 'brighten'
                            },
                            section: {
                                color: '#9146ff',
                                size: 1,
                                style: 'gradient',
                                margin: 40
                            }
                        },
                        
                        // Unique/Experimental Themes
                        cyberpunk: {
                            bg: {c1: '#0e0b16', c2: '#0e0b16', style: 'solid'},
                            page: {enabled: true, bgColor: '#171123', shadowSize: 0, borderSize: 1, borderColor: '#fc0349', paddingX: 40, paddingY: 40, maxWidth: 1000},
                            type: {
                                bodyFont: "'Share Tech Mono', monospace",
                                headingFont: "'Share Tech Mono', monospace",
                                lineHeight: 1.7,
                                titleColor: '#fc0349',
                                titleSize: 36,
                                titleStyle: 'glitch',
                                titleAlign: 'left',
                                headingColor: '#4cc9f0',
                                headingSize: 24,
                                headingStyle: 'normal',
                                textColor: '#e6e6fa',
                                textSize: 16,
                                linkColor: '#fc0349',
                                linkHoverColor: '#f72585',
                                linkUnderline: false,
                                linkHoverEffect: 'glitch'
                            },
                            hero: {
                                enabled: true,
                                type: 'color',
                                c1: '#0e0b16',
                                c2: '#201b36',
                                style: 'gradient',
                                paddingX: 40,
                                paddingY: 70
                            },
                            img: {
                                borderSize: 1,
                                borderColor: '#4cc9f0',
                                padding: 0,
                                borderRadius: 0,
                                style: 'glitch',
                                hoverEffect: 'glitch'
                            },
                            section: {
                                color: '#4cc9f0',
                                size: 1,
                                style: 'glitch',
                                margin: 50
                            }
                        },
                        
                        vaporwave: {
                            bg: {c1: '#4e0094', c2: '#94007a', style: 'gradient'},
                            page: {enabled: true, bgColor: '#000030', shadowSize: 20, shadowColor: '#ff00ff50', borderSize: 2, borderColor: '#00ffff', paddingX: 40, paddingY: 40, maxWidth: 900, borderRadius: 0},
                            type: {
                                bodyFont: "'VT323', monospace",
                                headingFont: "'VT323', monospace",
                                lineHeight: 1.6,
                                titleColor: '#ff00ff',
                                titleSize: 42,
                                titleStyle: 'gradient',
                                titleAlign: 'center',
                                headingColor: '#00ffff',
                                headingSize: 28,
                                headingStyle: 'normal',
                                textColor: '#f5f5ff',
                                textSize: 18,
                                linkColor: '#ff00ff',
                                linkHoverColor: '#00ffff',
                                linkUnderline: false,
                                linkHoverEffect: 'glow'
                            },
                            hero: {
                                enabled: true,
                                type: 'color',
                                c1: '#000080',
                                c2: '#640064',
                                style: 'gradient',
                                paddingX: 40,
                                paddingY: 80
                            },
                            img: {
                                borderSize: 3,
                                borderColor: '#00ffff',
                                padding: 0,
                                borderRadius: 0,
                                style: 'retro',
                                hoverEffect: 'none'
                            },
                            section: {
                                color: '#ff00ff',
                                size: 2,
                                style: 'gradient',
                                margin: 40
                            }
                        },
                        
                        brutalist: {
                            bg: {c1: '#ffffff', c2: '#ffffff', style: 'solid'},
                            page: {enabled: true, bgColor: '#ffffff', shadowSize: 0, borderSize: 4, borderColor: '#000000', paddingX: 30, paddingY: 30, maxWidth: 1200, borderRadius: 0},
                            type: {
                                bodyFont: "'Helvetica Neue', Helvetica, Arial, sans-serif",
                                headingFont: "'Helvetica Neue', Helvetica, Arial, sans-serif",
                                lineHeight: 1.5,
                                titleColor: '#000000',
                                titleSize: 60,
                                titleStyle: 'normal',
                                titleAlign: 'left',
                                headingColor: '#000000',
                                headingSize: 32,
                                headingStyle: 'normal',
                                textColor: '#000000',
                                textSize: 20,
                                linkColor: '#000000',
                                linkHoverColor: '#000000',
                                linkUnderline: true,
                                linkHoverEffect: 'highlight'
                            },
                            hero: {
                                enabled: false
                            },
                            img: {
                                borderSize: 4,
                                borderColor: '#000000',
                                padding: 0,
                                borderRadius: 0,
                                style: 'normal',
                                hoverEffect: 'none'
                            },
                            section: {
                                color: '#000000',
                                size: 4,
                                style: 'solid',
                                margin: 40
                            }
                        },
                        
                        handwritten: {
                            bg: {c1: '#fffbf2', c2: '#fffbf2', style: 'solid'},
                            page: {enabled: true, bgColor: '#fffbf2', shadowSize: 0, borderSize: 0, paddingX: 40, paddingY: 40, maxWidth: 800},
                            type: {
                                bodyFont: "'Caveat', cursive",
                                headingFont: "'Caveat', cursive",
                                lineHeight: 1.6,
                                titleColor: '#333333',
                                titleSize: 52,
                                titleStyle: 'normal',
                                titleAlign: 'center',
                                headingColor: '#333333',
                                headingSize: 32,
                                headingStyle: 'normal',
                                textColor: '#333333',
                                textSize: 22,
                                linkColor: '#4b91e2',
                                linkHoverColor: '#2e6bb3',
                                linkUnderline: true,
                                linkHoverEffect: 'none'
                            },
                            hero: {
                                enabled: false
                            },
                            img: {
                                borderSize: 0,
                                padding: 0,
                                borderRadius: 0,
                                style: 'sketch',
                                hoverEffect: 'none'
                            },
                            section: {
                                color: '#d3a45c',
                                size: 1,
                                style: 'symbols',
                                symbol: '✎',
                                margin: 40
                            },
                            advanced: {
                                contentWidth: 85,
                                paragraphIndent: 0,
                                paragraphSpacing: 25,
                                paperTexture: true
                            }
                        },
                        
                        vintage: {
                            bg: {c1: '#ded1bd', c2: '#d4c6af', style: 'solid'},
                            page: {enabled: true, bgColor: '#f1e9dc', shadowSize: 5, borderSize: 0, paddingX: 50, paddingY: 50, maxWidth: 750},
                            type: {
                                bodyFont: "'Libre Baskerville', serif",
                                headingFont: "'Old Standard TT', serif",
                                lineHeight: 1.7,
                                titleColor: '#5c5346',
                                titleSize: 42,
                                titleStyle: 'normal',
                                titleAlign: 'center',
                                headingColor: '#5c5346',
                                headingSize: 28,
                                headingStyle: 'normal',
                                textColor: '#5c5346',
                                textSize: 16,
                                linkColor: '#8e775e',
                                linkHoverColor: '#5c5346',
                                linkUnderline: true,
                                linkHoverEffect: 'none'
                            },
                            hero: {
                                enabled: false
                            },
                            img: {
                                borderSize: 5,
                                borderColor: '#ffffff',
                                padding: 5,
                                borderRadius: 0,
                                style: 'vintage',
                                hoverEffect: 'none'
                            },
                            section: {
                                color: '#ada393',
                                size: 1,
                                style: 'ornate',
                                margin: 40
                            },
                            advanced: {
                                contentWidth: 85,
                                paragraphIndent: 30,
                                paragraphSpacing: 20,
                                paperTexture: true,
                                textureOpacity: 0.2
                            }
                        },
                        
                        // Additional Professional Themes
                        finance: {
                            bg: {c1: '#f7f7f7', c2: '#f7f7f7', style: 'solid'},
                            page: {enabled: true, bgColor: '#ffffff', shadowSize: 5, borderSize: 0, paddingX: 60, paddingY: 60, maxWidth: 900},
                            type: {
                                bodyFont: "'Roboto', sans-serif",
                                headingFont: "'Roboto', sans-serif",
                                lineHeight: 1.6,
                                titleColor: '#0c4b33',
                                titleSize: 36,
                                titleStyle: 'normal',
                                titleAlign: 'left',
                                headingColor: '#0c4b33',
                                headingSize: 24,
                                headingStyle: 'normal',
                                textColor: '#333333',
                                textSize: 16,
                                linkColor: '#1e824c',
                                linkHoverColor: '#0c4b33',
                                linkUnderline: false,
                                linkHoverEffect: 'underline'
                            },
                            hero: {
                                enabled: true,
                                type: 'color',
                                c1: '#f0f7f4',
                                c2: '#f0f7f4',
                                style: 'solid',
                                paddingX: 50,
                                paddingY: 60
                            },
                            img: {
                                borderSize: 0,
                                padding: 0,
                                borderRadius: 4,
                                style: 'normal',
                                hoverEffect: 'none'
                            },
                            section: {
                                color: '#e0e0e0',
                                size: 1,
                                style: 'solid',
                                margin: 40
                            }
                        },
                        
                        educational: {
                            bg: {c1: '#fcfcfc', c2: '#f5f7fa', style: 'solid'},
                            page: {enabled: true, bgColor: '#ffffff', shadowSize: 10, borderSize: 0, paddingX: 50, paddingY: 50, maxWidth: 850},
                            type: {
                                bodyFont: "'Source Sans Pro', sans-serif",
                                headingFont: "'Raleway', sans-serif",
                                lineHeight: 1.7,
                                titleColor: '#3949ab',
                                titleSize: 38,
                                titleStyle: 'normal',
                                titleAlign: 'left',
                                headingColor: '#3949ab',
                                headingSize: 26,
                                headingStyle: 'leftBorder',
                                textColor: '#424242',
                                textSize: 17,
                                linkColor: '#3949ab',
                                linkHoverColor: '#283593',
                                linkUnderline: false,
                                linkHoverEffect: 'underline'
                            },
                            hero: {
                                enabled: true,
                                type: 'color',
                                c1: '#e8eaf6',
                                c2: '#e8eaf6',
                                style: 'solid',
                                paddingX: 40,
                                paddingY: 50
                            },
                            img: {
                                borderSize: 0,
                                padding: 0,
                                borderRadius: 8,
                                style: 'shadow',
                                hoverEffect: 'lift'
                            },
                            section: {
                                color: '#c5cae9',
                                size: 1,
                                style: 'solid',
                                margin: 40
                            }
                        },
                        
                        podcast: {
                            bg: {c1: '#2c3e50', c2: '#34495e', style: 'gradient'},
                            page: {enabled: true, bgColor: '#ffffff', shadowSize: 15, borderSize: 0, paddingX: 40, paddingY: 40, maxWidth: 850, borderRadius: 8},
                            type: {
                                bodyFont: "'Open Sans', sans-serif",
                                headingFont: "'Poppins', sans-serif",
                                lineHeight: 1.6,
                                titleColor: '#2c3e50',
                                titleSize: 40,
                                titleStyle: 'normal',
                                titleAlign: 'left',
                                headingColor: '#2c3e50',
                                headingSize: 26,
                                headingStyle: 'normal',
                                textColor: '#555555',
                                textSize: 16,
                                linkColor: '#e74c3c',
                                linkHoverColor: '#c0392b',
                                linkUnderline: false,
                                linkHoverEffect: 'underline'
                            },
                            hero: {
                                enabled: true,
                                type: 'color',
                                c1: '#ecf0f1',
                                c2: '#ecf0f1',
                                style: 'solid',
                                paddingX: 30,
                                paddingY: 50,
                                borderRadius: 8
                            },
                            img: {
                                borderSize: 0,
                                padding: 0,
                                borderRadius: 8,
                                style: 'shadow',
                                hoverEffect: 'lift'
                            },
                            section: {
                                color: '#ecf0f1',
                                size: 1,
                                style: 'symbols',
                                symbol: '🎙️',
                                margin: 40
                            }
                        },
                        
                        // Additional Creative Themes
                        musician: {
                            bg: {c1: '#0a0a0a', c2: '#101010', style: 'solid'},
                            page: {enabled: true, bgColor: '#0f0f0f', shadowSize: 0, borderSize: 0, paddingX: 20, paddingY: 20, maxWidth: 1100},
                            type: {
                                bodyFont: "'Work Sans', sans-serif",
                                headingFont: "'Work Sans', sans-serif",
                                lineHeight: 1.7,
                                titleColor: '#ffffff',
                                titleSize: 48,
                                titleStyle: 'normal',
                                titleAlign: 'center',
                                headingColor: '#ffffff',
                                headingSize: 30,
                                headingStyle: 'normal',
                                textColor: '#cccccc',
                                textSize: 16,
                                linkColor: '#f1c40f',
                                linkHoverColor: '#f39c12',
                                linkUnderline: false,
                                linkHoverEffect: 'opacity'
                            },
                            hero: {
                                enabled: true,
                                type: 'image',
                                overlayOpacity: 0.7,
                                paddingX: 20,
                                paddingY: 150,
                                titleEffect: 'shadow'
                            },
                            img: {
                                borderSize: 0,
                                padding: 0,
                                borderRadius: 0,
                                style: 'normal',
                                displayWidth: 'full',
                                hoverEffect: 'zoom'
                            },
                            section: {
                                color: '#333333',
                                size: 1,
                                style: 'symbols',
                                symbol: '♪',
                                margin: 60
                            }
                        },
                        
                        scifi: {
                            bg: {c1: '#0a1128', c2: '#0a1128', style: 'solid'},
                            page: {enabled: true, bgColor: '#0a1128', shadowSize: 0, borderSize: 1, borderColor: '#15b0e9', borderRadius: 8, paddingX: 40, paddingY: 40, maxWidth: 900},
                            type: {
                                bodyFont: "'Space Grotesk', sans-serif",
                                headingFont: "'Space Grotesk', sans-serif",
                                lineHeight: 1.7,
                                titleColor: '#15b0e9',
                                titleSize: 38,
                                titleStyle: 'normal',
                                titleAlign: 'left',
                                headingColor: '#15b0e9',
                                headingSize: 24,
                                headingStyle: 'leftBorder',
                                textColor: '#d1dbe8',
                                textSize: 16,
                                linkColor: '#15b0e9',
                                linkHoverColor: '#6fc7ec',
                                linkUnderline: false,
                                linkHoverEffect: 'glow'
                            },
                            hero: {
                                enabled: true,
                                type: 'color',
                                c1: '#061022',
                                c2: '#0a1128',
                                style: 'solid',
                                paddingX: 40,
                                paddingY: 60,
                                borderRadius: 8
                            },
                            img: {
                                borderSize: 0,
                                padding: 0,
                                borderRadius: 8,
                                style: 'glow',
                                hoverEffect: 'brighten'
                            },
                            section: {
                                color: '#15b0e9',
                                size: 1,
                                style: 'gradient',
                                margin: 40
                            }
                        },
                        
                        minimalist: {
                            bg: {c1: '#ffffff', c2: '#ffffff', style: 'solid'},
                            page: {enabled: true, bgColor: '#ffffff', shadowSize: 0, borderSize: 0, paddingX: 40, paddingY: 40, maxWidth: 680},
                            type: {
                                bodyFont: "'Inter', sans-serif",
                                headingFont: "'Inter', sans-serif",
                                lineHeight: 1.6,
                                titleColor: '#000000',
                                titleSize: 32,
                                titleStyle: 'normal',
                                titleAlign: 'left',
                                headingColor: '#000000',
                                headingSize: 22,
                                headingStyle: 'normal',
                                textColor: '#444444',
                                textSize: 16,
                                linkColor: '#000000',
                                linkHoverColor: '#777777',
                                linkUnderline: true,
                                linkHoverEffect: 'none'
                            },
                            hero: {
                                enabled: false
                            },
                            img: {
                                borderSize: 0,
                                padding: 0,
                                borderRadius: 0,
                                style: 'normal',
                                hoverEffect: 'none'
                            },
                            section: {
                                color: '#eeeeee',
                                size: 1,
                                style: 'solid',
                                margin: 40
                            }
                        }


                    };
                    
                    // Apply the selected preset
                    if (presets[preset]) {
                        const p = presets[preset];
                        
                        // Deep merge the preset with current settings
                        Object.keys(p).forEach(key => {
                            this.p[key] = {...this.p[key], ...p[key]};
                        });
                        
                        this.updatePreview();
                    }
                },

                exportThemeJSON() {
                    const themeData = JSON.stringify(this.p, null, 2);
                    const blob = new Blob([themeData], { type: 'application/json' });
                    const url = URL.createObjectURL(blob);
                    
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'blackquartz-theme.json';
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                },


                importThemeJSON() {
                    const input = document.createElement('input');
                    input.type = 'file';
                    input.accept = '.json,.css'; // Accept both JSON and CSS files
                    
                    input.onchange = e => {
                        const file = e.target.files[0];
                        if (!file) return;
                        
                        const reader = new FileReader();
                        reader.onload = event => {
                        try {
                            const fileContent = event.target.result;
                            let jsonContent;
                            
                            // Check if this is a CSS file with embedded JSON
                            if (file.name.endsWith('.css')) {
                            // Extract JSON between markers
                            const startMarker = 'START_BLACKQUARTZ_THEME';
                            const endMarker = 'END_BLACKQUARTZ_THEME';
                            
                            const startIndex = fileContent.indexOf(startMarker);
                            const endIndex = fileContent.indexOf(endMarker);
                            
                            if (startIndex !== -1 && endIndex !== -1) {
                                // Extract the JSON string (add length of marker to get position after the marker)
                                jsonContent = fileContent.substring(startIndex + startMarker.length, endIndex).trim();
                            } else {
                                throw new Error('No BlackQuartz theme settings found in this CSS file');
                            }
                            } else {
                            // Assume it's a regular JSON file
                            jsonContent = fileContent;
                            }
                            
                            // Parse the JSON and apply it
                            const importedTheme = JSON.parse(jsonContent);
                            this.applyImportedTheme(importedTheme);
                        } catch (error) {
                            alert('Error importing theme: ' + error.message);
                        }
                        };
                        reader.readAsText(file);
                    };
                    
                    input.click();
                    },

                applyImportedTheme(importedTheme) {
                // Deep merge that preserves new fields
                const deepMerge = (target, source) => {
                    for (const key in source) {
                    if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {
                        if (!target[key]) target[key] = {};
                        deepMerge(target[key], source[key]);
                    } else {
                        target[key] = source[key];
                    }
                    }
                };
                
                // Create a copy of current settings as the base (preserves new fields)
                const updatedTheme = JSON.parse(JSON.stringify(this.p));
                
                // Apply imported settings
                deepMerge(updatedTheme, importedTheme);
                
                // Update the theme
                this.p = updatedTheme;
                },

                // Utility functions
                hexToRgb(hex) {
                    const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
                    return result ? 
                        parseInt(result[1], 16) + ',' + 
                        parseInt(result[2], 16) + ',' + 
                        parseInt(result[3], 16)
                        : '0,0,0';
                },
                
                darkenColor(hex, percent) {
                    // Strip the leading # if it exists
                    hex = hex.replace(/^\s*#|\s*$/g, '');

                    // Convert 3 char to 6 char
                    if(hex.length == 3) {
                        hex = hex.replace(/(.)/g, '$1$1');
                    }

                    // Convert hex to rgb
                    var rgb = parseInt(hex, 16);
                    var r = (rgb >> 16) & 0xff;
                    var g = (rgb >>  8) & 0xff;
                    var b = (rgb >>  0) & 0xff;

                    // Darken
                    r = Math.max(0, Math.floor(r * (100 - percent) / 100));
                    g = Math.max(0, Math.floor(g * (100 - percent) / 100));
                    b = Math.max(0, Math.floor(b * (100 - percent) / 100));

                    // Convert back to hex
                    return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
                },
                
                lightenColor(hex, percent) {
                    // Strip the leading # if it exists
                    hex = hex.replace(/^\s*#|\s*$/g, '');

                    // Convert 3 char to 6 char
                    if(hex.length == 3) {
                        hex = hex.replace(/(.)/g, '$1$1');
                    }

                    // Convert hex to rgb
                    var rgb = parseInt(hex, 16);
                    var r = (rgb >> 16) & 0xff;
                    var g = (rgb >>  8) & 0xff;
                    var b = (rgb >>  0) & 0xff;

                    // Lighten
                    r = Math.min(255, Math.floor(r * (100 + percent) / 100));
                    g = Math.min(255, Math.floor(g * (100 + percent) / 100));
                    b = Math.min(255, Math.floor(b * (100 + percent) / 100));

                    // Convert back to hex
                    return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
                }
            },
            watch: {
            p: {
                handler() {
                this.updatePreview();
                },
                deep: true
            },
            'responsivePreview.device': function() {
                this.updatePreview();
            },
            'responsivePreview.enabled': function() {
                this.updatePreview();
            }
            },
            created() {
                // Create debounced function for Wikipedia search
                this.debouncedWikiSearch = this.debounce(() => {
                    if (this.wikiSearch.length > 2) {
                        this.searchWikipedia(this.wikiSearch);
                    } else {
                        this.wikiResults = [];
                    }
                }, 500);
            },
            mounted() {
                this.generateLoremTextCache();
                this.updatePreview();
                
                // For demo, can fetch Google Fonts API in a real implementation
                // This would populate ALL_GOOGLE_FONTS with the complete list
            }
        });
    </script>
</body>
</html>