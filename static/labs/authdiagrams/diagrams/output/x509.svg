<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="776px" preserveAspectRatio="none" style="width:715px;height:776px;background:#282828;" version="1.1" viewBox="0 0 715 776" width="715px" zoomAndPan="magnify"><defs/><g><rect fill="#282828" height="776" style="stroke:none;stroke-width:1.0;" width="715" x="0" y="0"/><line style="stroke:#CCCCCC;stroke-width:1.0;" x1="60" x2="60" y1="54.0293" y2="723.6143"/><line style="stroke:#CCCCCC;stroke-width:1.0;" x1="303.771" x2="303.771" y1="54.0293" y2="723.6143"/><line style="stroke:#CCCCCC;stroke-width:1.0;" x1="487.7285" x2="487.7285" y1="54.0293" y2="723.6143"/><rect fill="#3C3F41" height="48.0293" rx="2.5" ry="2.5" style="stroke:#E8E8E8;stroke-width:1.0;" width="80.1377" x="20" y="5"/><text fill="#E8E8E8" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="66.1377" x="27" y="26.0752">Service A</text><text fill="#E8E8E8" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="52.8896" x="33.624" y="43.0898">(Client)</text><rect fill="#3C3F41" height="48.0293" rx="2.5" ry="2.5" style="stroke:#E8E8E8;stroke-width:1.0;" width="80.1377" x="20" y="722.6143"/><text fill="#E8E8E8" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="66.1377" x="27" y="743.6895">Service A</text><text fill="#E8E8E8" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="52.8896" x="33.624" y="760.7041">(Client)</text><rect fill="#3C3F41" height="48.0293" rx="2.5" ry="2.5" style="stroke:#E8E8E8;stroke-width:1.0;" width="85.7705" x="261.771" y="5"/><text fill="#E8E8E8" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="71.7705" x="268.771" y="26.0752">Certificate</text><text fill="#E8E8E8" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="64.9209" x="272.1958" y="43.0898">Authority</text><rect fill="#3C3F41" height="48.0293" rx="2.5" ry="2.5" style="stroke:#E8E8E8;stroke-width:1.0;" width="85.7705" x="261.771" y="722.6143"/><text fill="#E8E8E8" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="71.7705" x="268.771" y="743.6895">Certificate</text><text fill="#E8E8E8" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="64.9209" x="272.1958" y="760.7041">Authority</text><rect fill="#3C3F41" height="48.0293" rx="2.5" ry="2.5" style="stroke:#E8E8E8;stroke-width:1.0;" width="80.165" x="447.7285" y="5"/><text fill="#E8E8E8" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="66.165" x="454.7285" y="26.0752">Service B</text><text fill="#E8E8E8" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="59.1992" x="458.2114" y="43.0898">(Server)</text><rect fill="#3C3F41" height="48.0293" rx="2.5" ry="2.5" style="stroke:#E8E8E8;stroke-width:1.0;" width="80.165" x="447.7285" y="722.6143"/><text fill="#E8E8E8" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="66.165" x="454.7285" y="743.6895">Service B</text><text fill="#E8E8E8" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="59.1992" x="458.2114" y="760.7041">(Server)</text><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1.0;" width="703.585" x="5" y="84.929"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="708.585" y1="84.929" y2="84.929"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="708.585" y1="87.929" y2="87.929"/><rect fill="#FFFFFF" height="23.7993" style="stroke:#000000;stroke-width:1.0;" width="109.3228" x="302.1311" y="74.0293"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="90.8794" x="308.1311" y="91.0991">Initial Setup</text><line style="stroke:#E8E8E8;stroke-width:1.0;" x1="60.0688" x2="102.0688" y1="129.6279" y2="129.6279"/><line style="stroke:#E8E8E8;stroke-width:1.0;" x1="102.0688" x2="102.0688" y1="129.6279" y2="142.6279"/><line style="stroke:#E8E8E8;stroke-width:1.0;" x1="61.0688" x2="102.0688" y1="142.6279" y2="142.6279"/><polygon fill="#E8E8E8" points="71.0688,138.6279,61.0688,142.6279,71.0688,146.6279,67.0688,142.6279" style="stroke:#E8E8E8;stroke-width:1.0;"/><text fill="#E8E8E8" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="117.311" x="67.0688" y="124.8984">Generate key pair</text><polygon fill="#E8E8E8" points="292.6563,168.4272,302.6563,172.4272,292.6563,176.4272,296.6563,172.4272" style="stroke:#E8E8E8;stroke-width:1.0;"/><line style="stroke:#E8E8E8;stroke-width:1.0;" x1="60.0688" x2="298.6563" y1="172.4272" y2="172.4272"/><text fill="#E8E8E8" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="220.5874" x="67.0688" y="167.6978">CSR (Certificate Signing Request)</text><polygon fill="#E8E8E8" points="71.0688,198.2266,61.0688,202.2266,71.0688,206.2266,67.0688,202.2266" style="stroke:#E8E8E8;stroke-width:1.0;"/><line style="stroke:#E8E8E8;stroke-width:1.0;" x1="65.0688" x2="303.6563" y1="202.2266" y2="202.2266"/><text fill="#E8E8E8" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="153.1055" x="77.0688" y="197.4971">Signed client certificate</text><line style="stroke:#E8E8E8;stroke-width:1.0;" x1="487.811" x2="529.811" y1="232.0259" y2="232.0259"/><line style="stroke:#E8E8E8;stroke-width:1.0;" x1="529.811" x2="529.811" y1="232.0259" y2="245.0259"/><line style="stroke:#E8E8E8;stroke-width:1.0;" x1="488.811" x2="529.811" y1="245.0259" y2="245.0259"/><polygon fill="#E8E8E8" points="498.811,241.0259,488.811,245.0259,498.811,249.0259,494.811,245.0259" style="stroke:#E8E8E8;stroke-width:1.0;"/><text fill="#E8E8E8" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="117.311" x="494.811" y="227.2964">Generate key pair</text><polygon fill="#E8E8E8" points="315.6563,270.8252,305.6563,274.8252,315.6563,278.8252,311.6563,274.8252" style="stroke:#E8E8E8;stroke-width:1.0;"/><line style="stroke:#E8E8E8;stroke-width:1.0;" x1="309.6563" x2="486.811" y1="274.8252" y2="274.8252"/><text fill="#E8E8E8" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="27.0029" x="321.6563" y="270.0957">CSR</text><polygon fill="#E8E8E8" points="475.811,300.6245,485.811,304.6245,475.811,308.6245,479.811,304.6245" style="stroke:#E8E8E8;stroke-width:1.0;"/><line style="stroke:#E8E8E8;stroke-width:1.0;" x1="304.6563" x2="481.811" y1="304.6245" y2="304.6245"/><text fill="#E8E8E8" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="159.1548" x="311.6563" y="299.895">Signed server certificate</text><path d="M12,317.6245 L12,358.6245 L534,358.6245 L534,327.6245 L524,317.6245 L12,317.6245 " fill="#3C3F41" style="stroke:#E8E8E8;stroke-width:1.0;"/><path d="M524,317.6245 L524,327.6245 L534,327.6245 L524,317.6245 " fill="#3C3F41" style="stroke:#E8E8E8;stroke-width:1.0;"/><text fill="#E8E8E8" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="351.1777" x="93.3579" y="335.6943">Both services are configured with CA's root certificate</text><text fill="#E8E8E8" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="340.3486" x="93.3579" y="351.4937">Certificates include service identity in SAN/CN fields</text><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1.0;" width="703.585" x="5" y="385.1228"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="708.585" y1="385.1228" y2="385.1228"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="708.585" y1="388.1228" y2="388.1228"/><rect fill="#FFFFFF" height="23.7993" style="stroke:#000000;stroke-width:1.0;" width="130.9556" x="291.3147" y="374.2231"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="112.5122" x="297.3147" y="391.293">TLS Connection</text><polygon fill="#E8E8E8" points="475.811,425.8218,485.811,429.8218,475.811,433.8218,479.811,429.8218" style="stroke:#E8E8E8;stroke-width:1.0;"/><line style="stroke:#E8E8E8;stroke-width:1.0;" x1="60.0688" x2="481.811" y1="429.8218" y2="429.8218"/><text fill="#E8E8E8" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="69.8433" x="67.0688" y="425.0923">ClientHello</text><polygon fill="#E8E8E8" points="71.0688,455.6211,61.0688,459.6211,71.0688,463.6211,67.0688,459.6211" style="stroke:#E8E8E8;stroke-width:1.0;"/><line style="stroke:#E8E8E8;stroke-width:1.0;" x1="65.0688" x2="486.811" y1="459.6211" y2="459.6211"/><text fill="#E8E8E8" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="199.3799" x="77.0688" y="454.8916">ServerHello, Server Certificate</text><line style="stroke:#E8E8E8;stroke-width:1.0;" x1="60.0688" x2="102.0688" y1="505.2197" y2="505.2197"/><line style="stroke:#E8E8E8;stroke-width:1.0;" x1="102.0688" x2="102.0688" y1="505.2197" y2="518.2197"/><line style="stroke:#E8E8E8;stroke-width:1.0;" x1="61.0688" x2="102.0688" y1="518.2197" y2="518.2197"/><polygon fill="#E8E8E8" points="71.0688,514.2197,61.0688,518.2197,71.0688,522.2197,67.0688,518.2197" style="stroke:#E8E8E8;stroke-width:1.0;"/><text fill="#E8E8E8" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="127.9814" x="67.0688" y="484.6909">Validate server cert</text><text fill="#E8E8E8" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="100.9595" x="67.0688" y="500.4902">against CA root</text><polygon fill="#E8E8E8" points="475.811,544.019,485.811,548.019,475.811,552.019,479.811,548.019" style="stroke:#E8E8E8;stroke-width:1.0;"/><line style="stroke:#E8E8E8;stroke-width:1.0;" x1="60.0688" x2="481.811" y1="548.019" y2="548.019"/><text fill="#E8E8E8" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="108.5195" x="67.0688" y="543.2896">Client Certificate</text><line style="stroke:#E8E8E8;stroke-width:1.0;" x1="487.811" x2="529.811" y1="593.6177" y2="593.6177"/><line style="stroke:#E8E8E8;stroke-width:1.0;" x1="529.811" x2="529.811" y1="593.6177" y2="606.6177"/><line style="stroke:#E8E8E8;stroke-width:1.0;" x1="488.811" x2="529.811" y1="606.6177" y2="606.6177"/><polygon fill="#E8E8E8" points="498.811,602.6177,488.811,606.6177,498.811,610.6177,494.811,606.6177" style="stroke:#E8E8E8;stroke-width:1.0;"/><text fill="#E8E8E8" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="121.9321" x="494.811" y="573.0889">Validate client cert</text><text fill="#E8E8E8" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="100.9595" x="494.811" y="588.8882">against CA root</text><polygon fill="#E8E8E8" points="71.0688,667.0156,61.0688,671.0156,71.0688,675.0156,67.0688,671.0156" style="stroke:#E8E8E8;stroke-width:1.0;"/><polygon fill="#E8E8E8" points="475.811,667.0156,485.811,671.0156,475.811,675.0156,479.811,671.0156" style="stroke:#E8E8E8;stroke-width:1.0;"/><line style="stroke:#E8E8E8;stroke-width:1.0;" x1="65.0688" x2="481.811" y1="671.0156" y2="671.0156"/><text fill="#E8E8E8" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="256.7183" x="77.0688" y="666.2861">Key Exchange &amp; Session Establishment</text><path d="M492,619.6177 L492,707.6177 L697,707.6177 L697,629.6177 L687,619.6177 L492,619.6177 " fill="#3C3F41" style="stroke:#E8E8E8;stroke-width:1.0;"/><path d="M687,619.6177 L687,629.6177 L697,629.6177 L687,619.6177 " fill="#3C3F41" style="stroke:#E8E8E8;stroke-width:1.0;"/><text fill="#E8E8E8" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="114.9688" x="498" y="637.6875">Both sides verify:</text><text fill="#E8E8E8" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="116.2891" x="498" y="653.4868">- Certificate chain</text><text fill="#E8E8E8" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="82.5195" x="498" y="669.2861">- Valid dates</text><text fill="#E8E8E8" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="173.8623" x="498" y="685.0854">- Not revoked (CRL/OCSP)</text><text fill="#E8E8E8" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="184.7739" x="498" y="700.8848">- Identity matches expected</text><!--SRC=[jLPTJzim57tFhxXZqWOIg6Fb0Q5rKXCee250PDeJBsvoarXrxSnseTsltxNfHvAsAHkRhKgDVNpkkUVUM7bd2nmZb89n6PWHboNJR0n3benohIOoZPHG6jv_FdMpWZZ7Z4s47IXfvv2BKpShaBxMwddRPem_9oWJlAGePQXqYheEhM3lcROyuIMJDcmAwqRTmSdn5l06set0zImgk5jbSNTOZsgDvn2jWUgMx8pOS32TXJkBjjNi1kJrCg-G4LbR5_p_h1P7RdY6Wijw6H8_Dka_vq-yhlsJ7w_MVjvr4sXqEWIrflBQGE8n6VtSGWb3DKNpglxl-W7piQJsa3-ZRQGs600qQJE2h94ADaJHoXhpNmZ79z0On7fNMgua4sSLVkFGQ_IRQXAgwTjiBdm_cYtK_znc8lrRarkLljdZ1NiGbAjhZk3wYIVO1sPWR_u0_KUv7mcEqXxirT3H2ov2MifumYm-olx45afpEzlRH1pMY4CYTlzH4t7Gwy6rv9OpuLIJn5ulMEev-hhKTWQNA55JD1ZX34h6TGqN4IAA7s2_eWjYdaikStXm5Xfx44GDJWT0QXUV9oIheq6mrBuw4BQ822iYwc72PHZZiww7aNJzWtBB2rM7AziMzo10g6pXpzEw0QQH6aTcF9zeudtcj1drFnhGIjNJ0AZuOO3BH4nIN301tNJIKjbe0-B-RIUwXOoZI4s0z1OvRRv2tszYY9IKcBWEsr8YolEbNwvG2BN9FsUujy0Z3kSFLOLRIl-32PuwroiEFagMqzU9yGtfycxLj2b8exJB89LkQ0dofNRu6xN3nJGfcCmHFj26CSwf2sFPK71JZ8bnNcpDyyAkbPOgOO1ouzdiZ1QFgeA1UEaxpArwaU1a6lzCNm-WyKcDg0tseuURpbqKtn_uhUj5RSVC9WMnuxIa0cAwgkrl]--></g></svg>